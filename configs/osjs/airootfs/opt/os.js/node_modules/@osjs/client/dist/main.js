!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("osjsClient",[],e):"object"==typeof exports?exports.osjsClient=e():t.osjsClient=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=22)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var r=n(15),o=n(9);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}},function(t,e,n){var r=n(18);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){(function(e){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){t.exports=n(3)},function(t,e,n){"use strict";n.r(e),n.d(e,"EventEmitter",function(){return u});var r=n(0),o=n.n(r),i=n(1),s=n.n(i),a=function(t){return t instanceof Array?t:String(t).replace(/\s+/g,"").split(",")},u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined";o()(this,t),this.name=e,this.events={}}return s()(t,[{key:"destroy",value:function(){this.events={}}},{key:"on",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r=r||{},"function"!=typeof e)throw new TypeError("Invalid callback");return a(t).forEach(function(t){n.events[t]||(n.events[t]=[]),n.events[t].push({callback:e,options:r})}),this}},{key:"once",value:function(t,e){return this.on(t,e,{once:!0})}},{key:"off",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a(t).filter(function(t){return!!e.events[t]}).forEach(function(t){if(n)for(var o=e.events[t].length;o--;){var i=e.events[t][o];(!i.options.persist||r)&&i.callback===n&&e.events[t].splice(o,1)}else e.events[t]=r?[]:e.events[t].filter(function(t){return!0!==t.options.persist})}),this}},{key:"emit",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return a(t).forEach(function(t){if(e.events[t])for(var n=e.events[t].length;n--;){var o=e.events[t][n],i=o.options,s=o.callback;try{s.apply(void 0,r)}catch(t){console.warn(t)}i&&i.once&&e.events[t].splice(n,1)}}),this}}]),t}()}])}).call(this,n(19))},function(t,e,n){var r=n(24),o=n(25),i=n(26);t.exports=function(t){return r(t)||o(t)||i()}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){(function(t){!function(t,e){for(var n in e)t[n]=e[n]}(e,function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=13)}([function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){t.exports=n(3)},function(t,e,n){"use strict";n.r(e),n.d(e,"EventEmitter",function(){return u});var r=n(0),o=n.n(r),i=n(1),s=n.n(i),a=function(t){return t instanceof Array?t:String(t).replace(/\s+/g,"").split(",")},u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined";o()(this,t),this.name=e,this.events={}}return s()(t,[{key:"destroy",value:function(){this.events={}}},{key:"on",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(r=r||{},"function"!=typeof e)throw new TypeError("Invalid callback");return a(t).forEach(function(t){n.events[t]||(n.events[t]=[]),n.events[t].push({callback:e,options:r})}),this}},{key:"off",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a(t).filter(function(t){return!!e.events[t]}).forEach(function(t){if(n)for(var o=e.events[t].length;o--;){var i=e.events[t][o];(!i.options.persist||r)&&i.callback===n&&e.events[t].splice(o,1)}else e.events[t]=r?[]:e.events[t].filter(function(t){return!0!==t.options.persist})}),this}},{key:"emit",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return a(t).forEach(function(t){e.events[t]&&e.events[t].forEach(function(t){return t.callback.apply(void 0,r)})}),this}}]),t}()}])},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(17))},function(t,e,n){t.exports=n(26)},function(t,e,n){"use strict";
/*!
   * isobject <https://github.com/jonschlinkert/isobject>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */t.exports=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)}},function(t,e,n){var r=n(14),o=n(4);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}},function(t,e,n){n(0);var r=n(15);function o(e,n,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,n){var o=r(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},o(e,n,i||e)}t.exports=o},function(t,e,n){var r=n(16);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){"use strict";var r=n(19),o=n(20);t.exports=function t(e,n){if(void 0===e)return{};if(Array.isArray(e)){for(var i=0;i<e.length;i++)e[i]=t(e[i],n);return e}if(!r(e))return e;if("string"==typeof n&&(n=[n]),!Array.isArray(n))return e;for(var s=0;s<n.length;s++)o(e,n[s]);for(var a in e)e.hasOwnProperty(a)&&(e[a]=t(e[a],n));return e}},function(t,e){function n(t,e,n,r,o,i,s){try{var a=t[i](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var s=t.apply(e,r);function a(t){n(s,o,i,a,u,"next",t)}function u(t){n(s,o,i,a,u,"throw",t)}a(void 0)})}}},function(t,e,n){t.exports=n(28)},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e,n){var r=n(0);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(18),o=function(){function t(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}return t.prototype.addNode=function(t){if(this.hasNode(t.name))throw new Error('A node with the name of "'+t.name+'" already exists in the graph!');this.nodes[t.name]=t,this.outgoingEdges[t.name]=[],this.incomingEdges[t.name]=[]},t.prototype.removeNode=function(t){if(!this.hasNode(t))throw new Error('A node with the name of "'+t+'" does not exist in the graph!');for(var e in delete this.nodes[t],delete this.outgoingEdges[t],delete this.incomingEdges[t],this.incomingEdges)this.incomingEdges[e].includes(t)&&this.incomingEdges[e].splice(e.indexOf(t),1);for(var n in this.outgoingEdges)this.outgoingEdges[n].includes(t)&&this.outgoingEdges[n].splice(n.indexOf(t),1)},t.prototype.hasNode=function(t){return this.nodes.hasOwnProperty(t)},Object.defineProperty(t.prototype,"size",{get:function(){return Object.keys(this.nodes).length},enumerable:!0,configurable:!0}),t.prototype.getNode=function(t){if(this.hasNode(t))return this.nodes[t];throw new Error('Node "'+t+'" not found!')},t.prototype.addDependency=function(t,e){if(!this.hasNode(t))throw new Error("Node does not exist: "+t);if(!this.hasNode(e))throw new Error("Node does not exist: "+e);if(t===e)throw new Error("Cannot add self dependency: "+e);this.outgoingEdges[t].includes(e)||this.outgoingEdges[t].push(e),this.incomingEdges[e].includes(t)||this.incomingEdges[e].push(t)},t.prototype.removeDependency=function(t,e){},t.prototype.dependenciesOf=function(t){return this.outgoingEdges[t]},t.prototype.dependentsOf=function(t){return this.incomingEdges[t]},t.prototype.traverse=function(){var t=this;Object.keys(this.nodes).map(function(e){return t.getNode(e).clearMutex()});var e=function(n){return Promise.all(t.dependenciesOf(n.name).map(function(e){return t.nodes[e].awaitData()})).then(function(){return n.signalDependenciesReady(),t.dependentsOf(n.name).length>0?Promise.all(t.dependentsOf(n.name).map(function(n){return e(t.getNode(n))})):n.awaitData()})},n=Object.keys(this.nodes).filter(function(e){return 0===t.dependenciesOf(e).length});if(0===n.length)throw new Error("Cannot traverse graph due to no root node. The graph may be circular");return Promise.all(n.map(function(n){return e(t.nodes[n])}))},t.prototype.clearNodeAndDependents=function(t){var e=this,n=this.getNode(t),r=function(t){return t.hasData()?(t.clearData(),Promise.all(e.dependentsOf(t.name).map(function(t){return r(e.getNode(t))}))):Promise.resolve()};return r(n)},t.prototype.reset=function(){for(var t in this.nodes)this.nodes[t].reset()},t.prototype.ls=function(){for(var t in this.nodes)console.log(t),console.log(this.dependentsOf(t))},t}();e.Graph=o;var i=function(){function t(t,e){this.locked=!1,this._name=t,this._promise=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.awaitData=function(){var t=this;return this.mutex||(this.mutex=new r.Mutex(function(){return void 0!==t._data})),new Promise(function(e,n){t.mutex.await(function(r){if(r)return n(r);e(t._data)})})},t.prototype.signalDependenciesReady=function(){var t=this;if(this.mutex||(this.mutex=new r.Mutex(function(){return void 0!==t._data})),void 0===this._data){if(!0===this.locked)return;this.locked=!0;var e=this._promise();if(void 0===e)throw new Error('Node "'+this._name+'" has undefined promise.');e.then(function(e){t._data=e,t.locked=!1,t.mutex.ready()}).catch(function(e){t._data=null,t.locked=!1,t.mutex.ready(e)})}else this.mutex.ready()},t.prototype.setData=function(t){this._data=t,this.signalDependenciesReady()},t.prototype.reset=function(){this.clearData(),this.clearMutex()},t.prototype.clearMutex=function(){this.hasData()&&(this.mutex=void 0)},t.prototype.hasData=function(){return void 0!==this._data},t.prototype.clearData=function(){this._data=void 0},t}();e.Node=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.readyTest=t}return t.prototype.await=function(t){!0===this.readyTest()?t():(this.waiting=this.waiting||[],this.waiting.push(t))},t.prototype.ready=function(t){this.waiting&&this.waiting.forEach(function(e){return e(t)}),delete this.waiting},t}();e.Mutex=r},function(t,e,n){"use strict";
/*!
   * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   */var r=n(7);function o(t){return!0===r(t)&&"[object Object]"===Object.prototype.toString.call(t)}t.exports=function(t){var e,n;return!1!==o(t)&&"function"==typeof(e=t.constructor)&&!1!==o(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")}},function(t,e,n){"use strict";
/*!
   * unset-value <https://github.com/jonschlinkert/unset-value>
   *
   * Copyright (c) 2015, 2017, Jon Schlinkert.
   * Released under the MIT License.
   */var r=n(7),o=n(21);t.exports=function(t,e){if(!r(t))throw new TypeError("expected an object.");if(t.hasOwnProperty(e))return delete t[e],!0;if(o(t,e)){for(var n=e.split("."),i=n.pop();n.length&&"\\"===n[n.length-1].slice(-1);)i=n.pop().slice(0,-1)+"."+i;for(;n.length;)t=t[e=n.shift()];return delete t[i]}return!0}},function(t,e,n){"use strict";
/*!
   * has-value <https://github.com/jonschlinkert/has-value>
   *
   * Copyright (c) 2014-2016, Jon Schlinkert.
   * Licensed under the MIT License.
   */var r=n(22),o=n(24),i=n(25);t.exports=function(t,e,n){return r(t)?o(i(t,e),n):o(t,e)}},function(t,e,n){"use strict";
/*!
   * isobject <https://github.com/jonschlinkert/isobject>
   *
   * Copyright (c) 2014-2015, Jon Schlinkert.
   * Licensed under the MIT License.
   */var r=n(23);t.exports=function(t){return null!=t&&"object"==typeof t&&!1===r(t)}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){"use strict";
/*!
   * has-values <https://github.com/jonschlinkert/has-values>
   *
   * Copyright (c) 2014-2015, Jon Schlinkert.
   * Licensed under the MIT License.
   */t.exports=function(t,e){if(null===t||void 0===t)return!1;if("boolean"==typeof t)return!0;if("number"==typeof t)return 0!==t||!0!==e;if(void 0!==t.length)return 0!==t.length;for(var n in t)if(t.hasOwnProperty(n))return!0;return!1}},function(t,e){function n(t){return t?Array.isArray(t)?t.join("."):t:""}
/*!
   * get-value <https://github.com/jonschlinkert/get-value>
   *
   * Copyright (c) 2014-2015, Jon Schlinkert.
   * Licensed under the MIT License.
   */t.exports=function(t,e,r,o,i){if(!function(t){return null!==t&&("object"==typeof t||"function"==typeof t)}(t)||!e)return t;if(e=n(e),r&&(e+="."+n(r)),o&&(e+="."+n(o)),i&&(e+="."+n(i)),e in t)return t[e];for(var s=e.split("."),a=s.length,u=-1;t&&++u<a;){for(var c=s[u];"\\"===c[c.length-1];)c=c.slice(0,-1)+"."+s[++u];t=t[c]}return t}},function(t,e,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,i=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(27),o)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag",c="object"==typeof t,l=e.regeneratorRuntime;if(l)c&&(t.exports=l);else{(l=e.regeneratorRuntime=c?t.exports:{}).wrap=_;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",m={},v={};v[s]=function(){return this};var L=Object.getPrototypeOf,g=L&&L(L(N([])));g&&g!==r&&o.call(g,s)&&(v=g);var y=A.prototype=b.prototype=Object.create(v);O.prototype=y.constructor=A,A.constructor=O,A[u]=O.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===O||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(y),t},l.awrap=function(t){return{__await:t}},w(T.prototype),T.prototype[a]=function(){return this},l.AsyncIterator=T,l.async=function(t,e,n,r){var o=new T(_(t,e,n,r));return l.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},w(y),y[u]="Generator",y[s]=function(){return this},y.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=N,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return a.type="throw",a.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function _(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),s=new j(r||[]);return i._invoke=function(t,e,n){var r=f;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return P()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=E(t,e,n);if("normal"===u.type){if(r=n.done?p:d,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,s),i}function E(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function b(){}function O(){}function A(){}function w(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function T(t){var e;this._invoke=function(n,r){function i(){return new Promise(function(e,i){!function e(n,r,i,s){var a=E(t[n],t,r);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,i,s)},function(t){e("throw",t,i,s)}):Promise.resolve(c).then(function(t){u.value=t,i(u)},function(t){return e("throw",t,i,s)})}s(a.arg)}(n,r,e,i)})}return e=e?e.then(i,i):i()}}function S(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,S(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=E(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,m;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function B(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(B,this),this.reset(!0)}function N(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e,n){"use strict";n.r(e);var r=n(2),o=n.n(r),i=n(3),s=n.n(i),a=n(8),u=n.n(a),c=n(0),l=n.n(c),f=n(9),d=n.n(f),h=n(10),p=n.n(h),m=n(4),v=n.n(m),L=n(5),g=function(t){var e={},n=[],r=[],o=function(t,e){var n=new L.Graph,r=t.map(function(t){return"function"==typeof t.provider.provides?t.provider.provides():[]});return t.forEach(function(t,r){n.addNode(new L.Node(String(r),function(){try{return Promise.resolve(t.provider[e]())}catch(t){return Promise.reject(t)}}))}),t.forEach(function(t,e){if(t.options.depends instanceof Array){var o=function(t){return r.findIndex(function(e){return e.some(function(e){return-1!==t.indexOf(e)})})}(t.options.depends);-1!==o&&n.addDependency(String(e),String(o))}}),n.traverse().catch(function(t){return console.warn(t)})};return{register:function(e,r){try{n.push({provider:new e(t,r.args),options:r})}catch(t){console.error("Provider register error",t)}},init:function(t){return function(t){return o(t,"init").then(function(){return o(t,"start")})}(t?n.filter(function(t){return t.options.before}):n.filter(function(t){return!t.options.before}))},bind:function(e,n,o){t.logger.info("Provider binding",e),r.push({singleton:n,name:e,make:function(){return o.apply(void 0,arguments)}})},has:function(t){return-1!==r.findIndex(function(e){return e.name===t})},make:function(t){var n=r.find(function(e){return e.name===t});if(!n)throw new Error("Provider '".concat(t,"' not found"));for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];return n.singleton?(e[t]||n&&(e[t]=n.make.apply(n,i)),e[t]):n.make.apply(n,i)},destroy:function(){!function(t,e){Promise.all(t.map(function(t){try{return t.provider.destroy()}catch(t){return Promise.reject(t)}})).catch(function(t){return console.warn(t)})}(n),e={},r=[]}}},y=n(1),_=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===E}(t)}(t)},E="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function b(t,e){return!1!==e.clone&&e.isMergeableObject(t)?A(function(t){return Array.isArray(t)?[]:{}}(t),t,e):t}function O(t,e,n){return t.concat(e).map(function(t){return b(t,n)})}function A(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||O,n.isMergeableObject=n.isMergeableObject||_;var r=Array.isArray(e);return r===Array.isArray(t)?r?n.arrayMerge(t,e,n):function(t,e,n){var r={};return n.isMergeableObject(t)&&Object.keys(t).forEach(function(e){r[e]=b(t[e],n)}),Object.keys(e).forEach(function(o){n.isMergeableObject(e[o])&&t[o]?r[o]=A(t[o],e[o],n):r[o]=b(e[o],n)}),r}(t,e,n):b(e,n)}A.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,n){return A(t,n,e)},{})};var w=A,T=n(11),S=n.n(T),B=function(t){function e(t,n,r){var i;o()(this,e),i=u()(this,l()(e).call(this,"Core"));var s=w.default?w.default:w,a=S()(t,r.omit||[]);return i.logger=console,i.configuration=s(a,n),i.options=r,i.booted=!1,i.started=!1,i.destroyed=!1,i.providers=g(v()(v()(i))),i}return p()(e,t),s()(e,[{key:"destroy",value:function(){return!this.destroyed&&(this.booted=!1,this.destroyed=!0,this.started=!1,this.providers.destroy(),d()(l()(e.prototype),"destroy",this).call(this),!0)}},{key:"boot",value:function(){return this.booted?Promise.resolve(!0):(this.started=!1,this.destroyed=!1,this.booted=!0,this.providers.init(!0).then(function(){return!0}))}},{key:"start",value:function(){return this.started?Promise.resolve(!0):(this.started=!0,this.providers.init(!1).then(function(){return!0}))}},{key:"config",value:function(t,e){return t?function(t,e,n){var r;try{r=e.split(/\./g).reduce(function(t,e){return t[e]},Object.assign({},t))}catch(t){}return void 0===r?n:r}(this.configuration,t,e):Object.assign({},this.configuration)}},{key:"register",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.providers.register(t,e)}},{key:"instance",value:function(t,e){this.providers.bind(t,!1,e)}},{key:"singleton",value:function(t,e){this.providers.bind(t,!0,e)}},{key:"make",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(e=this.providers).make.apply(e,[t].concat(r))}},{key:"has",value:function(t){return this.providers.has(t)}}]),e}(y.EventEmitter),k=n(6),j=n.n(k),N=n(12),P=n.n(N),R=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o()(this,t),this.core=e,this.options=n}return s()(t,[{key:"provides",value:function(){return[]}},{key:"init",value:function(){var t=P()(j.a.mark(function t(){return j.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"start",value:function(){}},{key:"destroy",value:function(){}}]),t}();n.d(e,"CoreBase",function(){return B}),n.d(e,"ServiceProvider",function(){return R}),n.d(e,"EventEmitter",function(){return y.EventHandler})}]))}).call(this,n(19))},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){n(2);var r=n(27);function o(e,n,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,n){var o=r(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},o(e,n,i||e)}t.exports=o},function(t,e,n){var r=n(28),o=n(29),i=n(30);t.exports=function(t,e){return r(t)||o(t,e)||i()}},function(t,e,n){t.exports=n(32)},function(t,e,n){var r=n(18);function o(e,n,i){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?t.exports=o=function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&r(i,n.prototype),i}:t.exports=o=Reflect.construct,o.apply(null,arguments)}t.exports=o},function(t,e,n){t.exports=n.p+"881c86876af63b732063d7bdd51bb226.png"},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e){function n(t,e,n,r,o,i,s){try{var a=t[i](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(r,o)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var s=t.apply(e,r);function a(t){n(s,o,i,a,u,"next",t)}function u(t){n(s,o,i,a,u,"throw",t)}a(void 0)})}}},function(t,e,n){window,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e,n){var r=n(5),o=n(6),i=n(7);t.exports=function(t,e){return r(t)||o(t,e)||i()}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e,n){t.exports=n(4)},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),i=n(2),s=n.n(i),a=n(0),u=n.n(a),c=function(t){return void 0===t?t:JSON.parse(JSON.stringify(t))},l=function(t){return t.split(/\./g)},f=function(t){return void 0===t||null===t},d=function(t){return!!t&&"object"===u()(t)&&!Array.isArray(t)},h=function t(e,n){if(d(e)&&d(n)){for(var r in n)d(n[r])?(e[r]&&u()(e[r])===u()(n[r])||Object.assign(e,s()({},r,{})),t(e[r],n[r])):Object.assign(e,s()({},r,n[r]));return e}return n},p=function(t,e,n){if(f(e))return t;var r;try{r=l(e).reduce(function(t,e){return t[e]},Object.assign({},t))}catch(t){}return void 0===r?n:r},m=function(t,e,n){var r=l(e),o=r.length;if(n)for(var i=t,s=0;s<o;s++){var a=r[s];void 0===i[a]&&(i[a]={}),i=i[a]}var u=1===o?r[0]:r.pop();return[1===o?t:p(t,r.join(".")),u]};e.default=function(t){var e,n=function(t){return e=c(t)};return n(t),{get:function(t,n){return c(p(e,t,n))},set:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return c(function(t,e,n,r){if(!1!==r.parse)try{n=void 0===n?n:JSON.parse(n)}catch(t){}if(f(e)){var i=!1!==r.merge?h(t,n):n;return Object.assign(t,i)}var s=m(t,e,!0),a=o()(s,2),u=a[0],c=a[1];f(u[c])&&(u[c]={});var l=!1!==r.merge?h(u[c],n):n;return u[c]=l,l}(e,t,n,r))},push:function(t,n){return c(function(t,e,n){var r=p(t,e);if(!Array.isArray(r))throw new Error("The key '".concat(e,"' is not an array"));return r.push(n),r}(e,t,n))},remove:function(t){return c(function(t,e){var n=m(t,e),r=o()(n,2),i=r[0],s=r[1];return void 0!==i[s]&&(i instanceof Array?i.splice(i.indexOf(i[s]),1):delete i[s]),i}(e,t))},reset:function(e){return c(n(e||t))},toString:function(){return JSON.stringify(e)}}}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}}])},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r;!function(o){"use strict";var i=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g;return function(r,o,a,u){if(1!==arguments.length||"string"!==function(t){if(null===t)return"null";if(void 0===t)return"undefined";if("object"!=typeof t)return typeof t;if(Array.isArray(t))return"array";return{}.toString.call(t).slice(8,-1).toLowerCase()}(r)||/\d/.test(r)||(o=r,r=void 0),(r=r||new Date)instanceof Date||(r=new Date(r)),isNaN(r))throw TypeError("Invalid date");var c=(o=String(i.masks[o]||o||i.masks.default)).slice(0,4);"UTC:"!==c&&"GMT:"!==c||(o=o.slice(4),a=!0,"GMT:"===c&&(u=!0));var l=a?"getUTC":"get",f=r[l+"Date"](),d=r[l+"Day"](),h=r[l+"Month"](),p=r[l+"FullYear"](),m=r[l+"Hours"](),v=r[l+"Minutes"](),L=r[l+"Seconds"](),g=r[l+"Milliseconds"](),y=a?0:r.getTimezoneOffset(),_=function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.setDate(e.getDate()-(e.getDay()+6)%7+3);var n=new Date(e.getFullYear(),0,4);n.setDate(n.getDate()-(n.getDay()+6)%7+3);var r=e.getTimezoneOffset()-n.getTimezoneOffset();e.setHours(e.getHours()-r);var o=(e-n)/6048e5;return 1+Math.floor(o)}(r),E=function(t){var e=t.getDay();0===e&&(e=7);return e}(r),b={d:f,dd:s(f),ddd:i.i18n.dayNames[d],dddd:i.i18n.dayNames[d+7],m:h+1,mm:s(h+1),mmm:i.i18n.monthNames[h],mmmm:i.i18n.monthNames[h+12],yy:String(p).slice(2),yyyy:p,h:m%12||12,hh:s(m%12||12),H:m,HH:s(m),M:v,MM:s(v),s:L,ss:s(L),l:s(g,3),L:s(Math.round(g/10)),t:m<12?i.i18n.timeNames[0]:i.i18n.timeNames[1],tt:m<12?i.i18n.timeNames[2]:i.i18n.timeNames[3],T:m<12?i.i18n.timeNames[4]:i.i18n.timeNames[5],TT:m<12?i.i18n.timeNames[6]:i.i18n.timeNames[7],Z:u?"GMT":a?"UTC":(String(r).match(e)||[""]).pop().replace(n,""),o:(y>0?"-":"+")+s(100*Math.floor(Math.abs(y)/60)+Math.abs(y)%60,4),S:["th","st","nd","rd"][f%10>3?0:(f%100-f%10!=10)*f%10],W:_,N:E};return o.replace(t,function(t){return t in b?b[t]:t.slice(1,t.length-1)})}}();function s(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}i.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},i.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(r=function(){return i}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){"use strict";e.match=function(t,e){return u(t).some(function(t){var n=t.inverse,r="all"===t.type||e.type===t.type;if(r&&n||!r&&!n)return!1;var o=t.expressions.every(function(t){var n=t.feature,r=t.modifier,o=t.value,i=e[n];if(!i)return!1;switch(n){case"orientation":case"scan":return i.toLowerCase()===o.toLowerCase();case"width":case"height":case"device-width":case"device-height":o=f(o),i=f(i);break;case"resolution":o=l(o),i=l(i);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":o=c(o),i=c(i);break;case"grid":case"color":case"color-index":case"monochrome":o=parseInt(o,10)||1,i=parseInt(i,10)||0}switch(r){case"min":return i>=o;case"max":return i<=o;default:return i===o}});return o&&!n||!o&&n})},e.parse=u;var r=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,o=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,i=/^(?:(min|max)-)?(.+)/,s=/(em|rem|px|cm|mm|in|pt|pc)?$/,a=/(dpi|dpcm|dppx)?$/;function u(t){return t.split(",").map(function(t){var e=(t=t.trim()).match(r),n=e[1],s=e[2],a=e[3]||"",u={};return u.inverse=!!n&&"not"===n.toLowerCase(),u.type=s?s.toLowerCase():"all",a=a.match(/\([^\)]+\)/g)||[],u.expressions=a.map(function(t){var e=t.match(o),n=e[1].toLowerCase().match(i);return{modifier:n[1],feature:n[2],value:e[2]}}),u})}function c(t){var e,n=Number(t);return n||(n=(e=t.match(/^(\d+)\s*\/\s*(\d+)$/))[1]/e[2]),n}function l(t){var e=parseFloat(t);switch(String(t).match(a)[1]){case"dpcm":return e/2.54;case"dppx":return 96*e;default:return e}}function f(t){var e=parseFloat(t);switch(String(t).match(s)[1]){case"em":case"rem":return 16*e;case"cm":return 96*e/2.54;case"mm":return 96*e/2.54/10;case"in":return 96*e;case"pt":return 72*e;case"pc":return 72*e/12;default:return e}}},function(t,e,n){t.exports=n(34)},function(t,e,n){},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,n){var r=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){t.exports=n.p+"f4cfc6708cf6bfc17d4b1e775f594ae2.png"},function(t,e,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),o=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,i=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(33),o)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag",c="object"==typeof t,l=e.regeneratorRuntime;if(l)c&&(t.exports=l);else{(l=e.regeneratorRuntime=c?t.exports:{}).wrap=_;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",m={},v={};v[s]=function(){return this};var L=Object.getPrototypeOf,g=L&&L(L(N([])));g&&g!==r&&o.call(g,s)&&(v=g);var y=A.prototype=b.prototype=Object.create(v);O.prototype=y.constructor=A,A.constructor=O,A[u]=O.displayName="GeneratorFunction",l.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===O||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(y),t},l.awrap=function(t){return{__await:t}},w(T.prototype),T.prototype[a]=function(){return this},l.AsyncIterator=T,l.async=function(t,e,n,r){var o=new T(_(t,e,n,r));return l.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},w(y),y[u]="Generator",y[s]=function(){return this},y.toString=function(){return"[object Generator]"},l.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},l.values=N,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return a.type="throw",a.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=o.call(s,"catchLoc"),c=o.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function _(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),s=new j(r||[]);return i._invoke=function(t,e,n){var r=f;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===o)throw i;return P()}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=E(t,e,n);if("normal"===u.type){if(r=n.done?p:d,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,s),i}function E(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function b(){}function O(){}function A(){}function w(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function T(t){var e;this._invoke=function(n,r){function i(){return new Promise(function(e,i){!function e(n,r,i,s){var a=E(t[n],t,r);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"==typeof c&&o.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,i,s)},function(t){e("throw",t,i,s)}):Promise.resolve(c).then(function(t){u.value=t,i(u)},function(t){return e("throw",t,i,s)})}s(a.arg)}(n,r,e,i)})}return e=e?e.then(i,i):i()}}function S(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,S(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=E(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,m;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function B(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(B,this),this.reset(!0)}function N(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"draggable",function(){return S}),n.d(r,"droppable",function(){return B});var o={};n.r(o),n.d(o,"en_EN",function(){return Gt}),n.d(o,"fr_FR",function(){return Ht}),n.d(o,"nb_NO",function(){return Kt}),n.d(o,"sl_SI",function(){return $t}),n.d(o,"vi_VN",function(){return Wt}),n.d(o,"de_DE",function(){return zt});var i={};n.r(i),n.d(i,"parentDirectory",function(){return te}),n.d(i,"pathJoin",function(){return ee}),n.d(i,"humanFileSize",function(){return ie}),n.d(i,"transformReaddir",function(){return se}),n.d(i,"transformArrayBuffer",function(){return ae}),n.d(i,"getFileIcon",function(){return ue}),n.d(i,"createFileIter",function(){return ce});var s={};n.r(s),n.d(s,"readdir",function(){return de}),n.d(s,"readfile",function(){return he}),n.d(s,"writefile",function(){return pe}),n.d(s,"copy",function(){return me}),n.d(s,"rename",function(){return ve}),n.d(s,"move",function(){return Le}),n.d(s,"mkdir",function(){return ge}),n.d(s,"unlink",function(){return ye}),n.d(s,"exists",function(){return _e}),n.d(s,"stat",function(){return Ee}),n.d(s,"url",function(){return be}),n.d(s,"download",function(){return Oe}),n.d(s,"search",function(){return Ae}),n.d(s,"touch",function(){return we});n(23);var a=n(7),u=n.n(a),c=n(6),l=n.n(c),f=n(0),d=n.n(f),h=n(1),p=n.n(h),m=n(3),v=n.n(m),L=n(2),g=n.n(L),y=n(10),_=n.n(y),E=n(4),b=n.n(E),O=n(9),A=n.n(O),w=n(5),T=function(t){function e(t,n){var r;arguments.length>2&&void 0!==arguments[2]&&arguments[2];return d()(this,e),console.debug("Websocket::constructor()",t,n),(r=v()(this,g()(e).call(this,"Websocket@"+t))).connection=new WebSocket(n),r.connection.onopen=function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r).emit.apply(t,["open"].concat(n))},r.connection.onclose=function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r).emit.apply(t,["close"].concat(n))},r.connection.onmessage=function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r).emit.apply(t,["message"].concat(n))},r.connection.onerror=function(){for(var t,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(t=r).emit.apply(t,["error"].concat(n))},r}return b()(e,t),p()(e,[{key:"send",value:function(){var t;return(t=this.connection).send.apply(t,arguments)}},{key:"close",value:function(){var t;return(t=this.connection).close.apply(t,arguments)}}]),e}(w.EventEmitter),S=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},{type:"application/json",effect:"move",ondragstart:function(){return!0},ondragend:function(){return!0},setDragImage:null},e),r=n.type,o=n.effect,i=n.data,s=n.ondragstart,a=n.ondragend,u=n.setDragImage,c="function"==typeof u,l="application/json"===r?JSON.stringify(i):i,f=function(n){if(t.setAttribute("aria-grabbed","true"),n.dataTransfer){if(n.dataTransfer.setDragImage&&c)try{u(n,t,e)}catch(t){console.warn(t)}try{n.dataTransfer.effectAllowed=o,n.dataTransfer.setData(r,l)}catch(t){console.warn(t)}}return s(n)},d=function(e){return t.setAttribute("aria-grabbed","false"),a(e)};return t.setAttribute("draggable","true"),t.setAttribute("aria-grabbed","false"),t.addEventListener("dragstart",f),t.addEventListener("dragend",d),t.classList.add("osjs__draggable"),{destroy:function(){t.removeAttribute("draggable"),t.removeAttribute("aria-grabbed"),t.removeEventListener("dragstart",f),t.removeEventListener("dragend",d),t.classList.remove("osjs__draggable")}}},B=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},{type:"application/json",effect:"move",ondragenter:function(){return!0},ondragover:function(){return!0},ondragleave:function(){return!0},ondrop:function(){return!0}},e),r=n.type,o=n.effect,i=n.ondragenter,s=n.ondragover,a=n.ondragleave,u=n.ondrop,c=function(t){try{for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=t.apply(void 0,n);if("boolean"==typeof o)return o}catch(t){console.warn(t)}return!0},l=function(t){return i(t)},f=function(e){return t.classList.remove("osjs__drop"),c(a,e)},d=function(e){return e.preventDefault(),t.contains(e.target)?(e.stopPropagation(),e.dataTransfer.dropEffect=o,t.classList.add("osjs__drop"),c(s,e)):(t.classList.remove("osjs__drop"),!1)},h=function(e){var n,o=[];if(e.dataTransfer){o=e.dataTransfer.files?Array.from(e.dataTransfer.files):[];try{var i=e.dataTransfer.getData(r);try{n="application/json"===r?void 0===i?i:JSON.parse(i):i}catch(t){n=i,console.warn(t)}}catch(t){console.warn(t)}}return e.stopPropagation(),e.preventDefault(),t.classList.remove("osjs__drop"),c(u,e,n,o)};return t.setAttribute("aria-dropeffect",o),t.addEventListener("dragenter",l),t.addEventListener("dragover",d),t.addEventListener("dragleave",f),t.addEventListener("drop",h),t.classList.add("osjs__droppable"),{destroy:function(){t.removeAttribute("aria-dropeffect",o),t.removeEventListener("dragenter",l),t.removeEventListener("dragover",d),t.removeEventListener("dragleave",f),t.removeEventListener("drop",h),t.classList.remove("osjs__droppable")}}},k=function(t,e){return new Promise(function(n,r){var o=document.createElement("link");return o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),o.onload=function(){return n(o)},o.onerror=function(t){return r(t)},o.setAttribute("href",e),t.appendChild(o),o})},j=function(t,e){return new Promise(function(n,r){var o=document.createElement("script");return o.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||n(o)},o.onerror=function(t){return r(t)},o.onload=function(){return n(o)},o.src=e,t.appendChild(o),o})},N=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return function(){return t}}(),P=[],R=0,C=1,I=null,x=function(t){return Object.assign({classNames:[],modal:!1,ontop:!1,gravity:!1,moveable:!0,resizable:!0,focusable:!0,maximizable:!0,minimizable:!0,sessionable:!0,closeable:!0,header:!0,controls:!0,visibility:"global",shadowDOM:!1,mediaQueries:{small:"screen and (max-width: 640px)",medium:"screen and (min-width: 640px) and (max-width: 1024px)",big:"screen and (min-width: 1024px)"},minDimension:{width:100,height:100},maxDimension:{width:-1,height:-1}},t)},M=function(t,e,r){return Object.assign({title:e.title||e.id,icon:e.icon||n(14),media:null,moving:!1,resizing:!1,loading:!1,focused:!1,maximized:!1,minimized:!1,zIndex:1,styles:{},position:Object.assign({},{left:null,top:null},e.position),dimension:Object.assign({},{width:Math.max(r.minDimension.width,100),height:Math.max(r.minDimension.height,100)},e.dimension)},t)},D=function(t){var e=R;return R++,P.push(t),e},F='<div class="osjs-window-inner">\n  <div class="osjs-window-header">\n    <div class="osjs-window-icon">\n      <div></div>\n    </div>\n    <div class="osjs-window-title"></div>\n    <div class="osjs-window-button" data-action="minimize">\n      <div></div>\n    </div>\n    <div class="osjs-window-button" data-action="maximize">\n      <div></div>\n    </div>\n    <div class="osjs-window-button" data-action="close">\n      <div></div>\n    </div>\n  </div>\n  <div class="osjs-window-content">\n  </div>\n  <div class="osjs-window-resize" data-direction="n"></div>\n  <div class="osjs-window-resize" data-direction="nw"></div>\n  <div class="osjs-window-resize" data-direction="w"></div>\n  <div class="osjs-window-resize" data-direction="sw"></div>\n  <div class="osjs-window-resize" data-direction="s"></div>\n  <div class="osjs-window-resize" data-direction="se"></div>\n  <div class="osjs-window-resize" data-direction="e"></div>\n  <div class="osjs-window-resize" data-direction="ne"></div>\n</div>'.replace(/\n\s+/g,"").trim(),U=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(this,e),r=Object.assign({id:null,title:null,parent:null,template:null,attributes:{},position:{},dimension:{},state:{}},r),console.log("Window::constructor()",r),n=v()(this,g()(e).call(this,"Window@"+r.id)),"string"==typeof r.position&&(r.attributes.gravity=r.position,r.position={}),n.id=r.id,n.wid=D(A()(A()(n))),n.parent=r.parent,n.children=[],n.core=t,n.destroyed=!1,n.rendered=!1,n.attributes=x(r.attributes),n.state=M(r.state,r,n.attributes),n.$element=document.createElement("div"),n.$content=null,n.$header=null,n.$icon=null,n.$title=null,n._preventDefaultPosition=!1,n._loadingDebounce=null,n._template=r.template,n}return b()(e,t),p()(e,[{key:"destroy",value:function(){var t=this;if(!this.destroyed){this.destroyed=!0,console.debug("Window::destroy()"),this.emit("destroy",this),this.core.emit("osjs/window:destroy",this),this.children.forEach(function(t){return t.destroy()}),this.$element&&this.$element.remove(),I===this&&(I=null);var e=P.findIndex(function(e){return e===t});-1!==e&&P.splice(e,1),this.children=[],this.parent=null,this.$element=null,this.$content=null,this.$header=null,this.$icon=null,this.$title=null}}},{key:"init",value:function(){var t=this;if(this.inited)return this;this.parent&&(this.on("destroy",function(){var e=t.parent.children.findIndex(function(e){return e===t});-1!==e&&t.parent.children.splice(e,1)}),this.parent.children.push(this));var e=this.core.config("windows.template")||F;this._template?this.$element.innerHTML="function"==typeof this._template?this._template(this,e):this._template:this.$element.innerHTML=e;var n=this.core.make("osjs/window-behavior");n&&n.init(this);var r=B(this.$element,{ondragenter:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.emit.apply(t,["dragenter"].concat(n,[t]))},ondragover:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.emit.apply(t,["dragover"].concat(n,[t]))},ondragleave:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.emit.apply(t,["dragleave"].concat(n,[t]))},ondrop:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.emit.apply(t,["drop"].concat(n,[t]))}});return this.on("destroy",function(){return r.destroy()}),this.inited=!0,this.emit("init",this),this.core.emit("osjs/window:create",this),this}},{key:"render",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(this.rendered)return this;this.inited||this.init(),["osjs-window"].concat(l()(this.attributes.classNames)).filter(function(t){return!!t}).forEach(function(e){t.$element.classList.add(e)}),this.$content=this.$element.querySelector(".osjs-window-content"),this.$header=this.$element.querySelector(".osjs-window-header"),this.$icon=this.$element.querySelector(".osjs-window-icon > div"),this.$title=this.$element.querySelector(".osjs-window-title"),this.attributes.header||(this.$header.style.display="none");var n=function(e){return t.$header.querySelector(".osjs-window-button[data-action=".concat(e,"]")).style.display="none"};this.attributes.controls?(this.attributes.maximizable||n("maximize"),this.attributes.minimizable||n("minimize"),this.attributes.closeable||n("close")):Array.from(this.$header.querySelectorAll(".osjs-window-button")).forEach(function(t){return t.style.display="none"}),this._updateDOM(),this._preventDefaultPosition||this.gravitate(this.attributes.gravity);var r=this.core.make("osjs/desktop").getRect();return Object.assign(this.state.position,function(t,e){var n=e.dimension,r=e.position,o=t.width-n.width,i=t.height-n.height+t.top;return{left:Math.min(o,r.left),top:Math.max(t.top,Math.min(i,r.top))}}(r,this.state)),this.core.$root.appendChild(this.$element),this.attributes.modal&&this.parent&&(this.on("render",function(){return t.parent.setState("loading",!0)}),this.on("destroy",function(){t.parent.setState("loading",!1),t.parent.focus()})),function(){if("function"==typeof e){if(t.attributes.shadowDOM)try{var n="string"==typeof t.attributes.shadowDOM?t.attributes.shadowDOM:"open",r=t.$content.attachShadow({mode:n});return void e(r,t)}catch(t){console.warn("Shadow DOM not supported?",t)}e(t.$content,t)}}(),this.rendered=!0,this.setNextZindex(!0),setTimeout(function(){t.emit("render",t),t.core.emit("osjs/window:render",t)},1),this}},{key:"close",value:function(){this.destroyed||(this.emit("close",this),this.destroy())}},{key:"focus",value:function(){return!(this.state.minimized||!this._toggleState("focused",!0,"focus"))&&(I&&I!==this&&I.blur(),this.setNextZindex(),I=this,!0)}},{key:"blur",value:function(){var t=function(t){var e=document.activeElement;return t.contains(e)?e:null}(this.$element);return t&&t.blur(),this._toggleState("focused",!1,"blur")}},{key:"minimize",value:function(){return!this._toggleState("minimized",!0,"minimize")||this.blur()}},{key:"raise",value:function(){return this._toggleState("minimized",!1,"raise")}},{key:"maximize",value:function(){var t=this;return!!this._toggleState("maximized",!0,"maximize")&&(this.once("transitionend",function(){return t.emit("resized")}),!0)}},{key:"restore",value:function(){var t=this;return!!this._toggleState("maximized",!1,"restore")&&(this.once("transitionend",function(){return t.emit("resized")}),!0)}},{key:"resizeFit",value:function(t){t=t||this.$content.firstChild;var e=this.attributes.minDimension,n=this.attributes.maxDimension,r=Math.max(t.offsetWidth,e.width),o=Math.max(t.offsetHeight+this.$header.offsetHeight,e.height);n.width>0&&(r=Math.min(r,n.width)),n.height>0&&(o=Math.min(o,n.height)),isNaN(r)||isNaN(o)||this.setDimension({width:r,height:o})}},{key:"setIcon",value:function(t){this.state.icon=t,this._updateDOM()}},{key:"setTitle",value:function(t){this.state.title=t||"",this._updateDOM(),this.core.emit("osjs/window:change",this,"title",t)}},{key:"setDimension",value:function(t){var e=Object.assign({},this.state.dimension,t||{}),n=e.width,r=e.height;this.state.dimension.width=n,this.state.dimension.height=r,this._updateDOM()}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object.assign({},this.state.position,t||{}),r=n.left,o=n.top;this.state.position.top=o,this.state.position.left=r,e&&(this._preventDefaultPosition=!0),this._updateDOM()}},{key:"setZindex",value:function(t){this.state.zIndex=t,console.debug("Window::setZindex()",t),this._updateDOM()}},{key:"setNextZindex",value:function(t){(t||function(t){var e=t.wid,n=t.attributes,r=t.state,o=n.ontop,i=r.zIndex,s=P.filter(function(t){return t.attributes.ontop===o}).filter(function(t){return t.wid!==e}).map(function(t){return t.state.zIndex});return i<(s.length>0?Math.max.apply(null,s):0)}(this))&&(this.setZindex(C),C++)}},{key:"setState",value:function(t,e){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=function(){return n._setState(t,e,r)};"loading"===t&&r&&(clearTimeout(this._loadingDebounce),!0===e)?this._loadingDebounce=setTimeout(function(){return o()},250):o()}},{key:"gravitate",value:function(t){if(this.core.has("osjs/desktop")){var e=this.core.make("osjs/desktop").getRect(),n=this.state.position,r=n.left,o=n.top;if("center"===t)r=e.width/2-this.state.dimension.width/2,o=e.height/2-this.state.dimension.height/2;else if(t){var i=t.match(/top|bottom/),s=t.match(/left|rigth/);t.match(/top/)?o=e.top:t.match(/bottom/)&&(o=e.height-this.state.dimension.height+e.top),t.match(/left/)?r=e.left:t.match(/right/)&&(r=e.width-this.state.dimension.width),!i&&t.match(/center/)?o=e.height/2-this.state.dimension.height/2:!s&&t.match(/center/)&&(r=e.width/2-this.state.dimension.width/2)}this.setPosition({left:r,top:o})}}},{key:"getState",value:function(t){var e=this.state[t];return-1!==["position","dimension","styles"].indexOf(t)?Object.assign({},e):e}},{key:"getSession",value:function(){return!1===this.attributes.sessionable?null:{id:this.id,position:Object.assign({},this.state.position),dimension:Object.assign({},this.state.dimension)}}},{key:"_setState",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.state[t];this.state[t]=e,n&&(r!==e&&console.debug("Window::_setState()",t,e),this._updateDOM())}},{key:"_toggleState",value:function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.state[t]!==e&&(console.debug("Window::_toggleState()",t,e,n,r),this.state[t]=e,this.emit(n,this),this.core.emit("osjs/window:change",this,t,e),r&&this._updateDOM(),!0)}},{key:"_updateDOM",value:function(){if(this.inited){var t=this.$element,e=this.$title,n=this.$icon,r=this.id,o=this.state,i=this.attributes,s=o.dimension,a=s.width,u=s.height,c=o.position,l=c.top,f=c.left,d=o.title,h=o.icon,p=o.zIndex,m=o.styles,v={id:r,media:o.media,moving:o.moving,resizing:o.resizing,loading:o.loading,focused:o.focused,maximized:o.maximized,minimized:o.minimized,modal:i.modal,ontop:i.ontop,resizable:i.resizable,moveable:i.moveable,maximizable:i.maximizable,minimizable:i.minimizable},L=function(t){return Object.keys(t).map(function(t){return[t,t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()]}).map(function(e){return"".concat(e[1],": ").concat(t[e[0]])}).join(";")}(Object.assign({top:String(l)+"px",left:String(f)+"px",height:String(u)+"px",width:String(a)+"px",zIndex:(v.ontop?8388635:0)+p},m));e&&(e.innerHTML=function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent}(d)),n&&(n.style.backgroundImage="url(".concat(h,")")),t&&(Object.keys(v).forEach(function(e){return t.setAttribute("data-".concat(e),String(v[e]))}),t.style.cssText=L)}}}],[{key:"getWindows",value:function(){return P}},{key:"lastWindow",value:function(){return I}}]),e}(w.EventEmitter),G=n(11),H=n.n(G),K=n(15),$=n.n(K),W=[window.ArrayBuffer,window.ArrayBufferView,window.Blob,window.File,window.URLSearchParams,window.FormData].filter(function(t){return!!t}),z=function(t,e,n){var r=Object.assign({},{credentials:"same-origin",method:"get",headers:{}},e);"json"===n&&(r.headers=Object.assign(r.headers,{Accept:"application/json, text/plain, */*","Content-Type":"application/json"})),r.body&&"get"===r.method.toLowerCase()&&(t+="?"+function(t){return Object.keys(t).filter(function(e){return"object"!==$()(t[e])}).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}(r.body),delete r.body);var o=void 0!==r.body,i="string"==typeof r.body;"json"===n&&o&&!i&&(r.body instanceof FormData||W.find(function(t){return r.body instanceof t})||(r.body=JSON.stringify(r.body)));return[t,r]},V=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=z(t,e,n),o=H()(r,2),i=o[0],s=o[1];return window.fetch(i,s).then(function(t){return t.ok?"json"===n?t.json():t:t.json().then(function(e){return function(t,e){return Promise.reject(new Error(e||"".concat(t.status," (").concat(t.statusText,")")))}(t,e.error)})})},Y=[],q=0,Z=function(t){return"osjs/application/"+t.name},X=function(t){function e(t,n){var r;d()(this,e),n=Object.assign({},{args:{},options:{},metadata:{}},n),console.log("Application::constructor()",n);var o=n.options.settings?Object.assign({},n.options.settings):{},i=n.metadata&&n.metadata.name?"Application@"+n.metadata.name:"Application"+String(q);return(r=v()(this,g()(e).call(this,i))).pid=q,r.core=t,r.args=n.args,r.options=Object.assign({sessionable:!0,windowAutoFocus:!0},n.options),r.metadata=n.metadata,r.windows=[],r.workers=[],r.destroyed=!1,r.settings=t.make("osjs/settings").get(Z(r.metadata),null,o),r.started=new Date,r.sockets=[],Y.push(A()(A()(r))),q++,r.core.emit("osjs/application:create",A()(A()(r))),r}return b()(e,t),p()(e,[{key:"destroy",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.destroyed){this.destroyed=!0,this.emit("destroy"),this.core.emit("osjs/application:destroy",this);var n=function(t,e){try{t.forEach(e)}catch(t){console.warn(t)}return[]};if(this.windows=n(this.windows,function(t){return t.destroy()}),this.sockets=n(this.sockets,function(t){return t.close()}),this.workers=n(this.workers,function(t){return t.terminate()}),e){var r=Y.findIndex(function(e){return e===t});-1!==r&&Y.splice(r,1)}}}},{key:"relaunch",value:function(){var t=this,e=this.windows.map(function(t){return t.getSession()});this.destroy(),setTimeout(function(){t.core.run(t.metadata.name,Object.assign({},t.args),Object.assign({},t.options,{forcePreload:t.core.config("development"),restore:{windows:e}}))},1)}},{key:"resource",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.core.url(t,e,this.metadata)}},{key:"request",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"json",r=this.resource(t);return V(r,e,n)}},{key:"socket",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/socket",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=Object.assign({},{socket:{}},e);var n=this.resource(t,{type:"websocket"}),r=new T(this.metadata.name,n,e.socket);return this.sockets.push(r),r}},{key:"worker",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.resource(t),r=new Worker(n,Object.assign({credentials:"same-origin"},e));return this.workers.push(r),r}},{key:"createWindow",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.windows.find(function(t){return t.id===e.id})){var n=this.core.make("osjs/locale").translate("ERR_WINDOW_ID_EXISTS",e.id);throw new Error(n)}e.attributes=e.attributes||{classNames:["Window_".concat(this.metadata.name)]};var r,o=new U(this.core,e);if(o.init(),this.options.restore){var i=this.options.restore.windows||[],s=i.findIndex(function(t){return t.id===o.id});if(-1!==s){var a=i[s];o.setPosition(a.position,!0),o.setDimension(a.dimension),this.options.restore.windows.splice(s,1),r=!0}}return this.windows.push(o),this.emit("create-window",o),o.on("destroy",function(){if(!t.destroyed){var e=t.windows.findIndex(function(t){return t===o});-1!==e&&t.windows.splice(e,1)}t.emit("destroy-window",o)}),!r&&this.options.windowAutoFocus&&o.focus(),o}},{key:"removeWindow",value:function(t){for(var e=this.windows.length;e--;)t(this.windows[e],e)&&this.windows.splice(e,1)}},{key:"getSession",value:function(){return{args:Object.assign({},this.args),name:this.metadata.name,windows:this.windows.map(function(t){return t.getSession()}).filter(function(t){return null!==t})}}},{key:"emitAll",value:function(t){var e=this,n=function(t){return t.pid!==e.pid},r="function"==typeof t?t:"string"==typeof t?function(e){return n(e)&&e.metadata.name===t}:n;return function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Y.filter(r).map(function(e){return e.emit.apply(e,[t].concat(n))})}}},{key:"saveSettings",value:function(){var t=this.core.make("osjs/settings"),e=Z(this.metadata);return t.set(e,null,this.settings),t.save()}}],[{key:"getApplications",value:function(){return Y}},{key:"destroyAll",value:function(){Y.forEach(function(t){try{t.destroy(!1)}catch(t){console.warn(t)}}),Y.splice(0,Y.length)}}]),e}(w.EventEmitter),Q=n(8),J=n(20),tt=n.n(J),et={nb:"nb_NO"},nt=/\{(\d+)\}/g,rt=function(t,e){var n=function(t,e){return t.config("locale."+e)}(t,e);return{defaultLocale:n,userLocale:function(t,e,n){return t.make("osjs/settings").get("osjs/locale",e,n)}(t,e,n)}},ot=function(t){return function(e){var n=rt(t,"language"),r=n.defaultLocale,o=n.userLocale;return function(t){for(var n=arguments.length,i=new Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];return function(t,e,n,r){for(var o=function(t,e,n,r){return(t[e]||t[n]||t.en_EN||{})[r]||r}(t,e,n,r),i=arguments.length,s=new Array(i>4?i-4:0),a=4;a<i;a++)s[a-4]=arguments[a];return o.replace(nt,function(t){return function(e,n){return n in t?t[n]:e}}(s))}.apply(void 0,[e,o,r,t].concat(i))}}},it=function(){var t=window.navigator||{},e=t.userLanguage||t.language||"",n=(t.languages||[e]).map(function(t){return function(t){return et[t]?et[t]:t.match(/_/)?t:t?"".concat(t,"_").concat(t.toUpperCase()):""}(t.replace("-","_"))}),r=n[n.length-1];return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en_EN";return r||t}}(),st=window.location,at=st.pathname,ut=st.href,ct="/"!==at.substr(-1)?at+"/":at,lt=ut.replace(/[^/]*$/,""),ft={development:!"production".match(/^prod/i),standalone:!1,http:{public:ct,uri:lt},ws:{uri:lt.replace(/^http/,"ws")},languages:{en_EN:"English",nb_NO:"Norwegian, Norsk (bokml)",vi_VN:"Vietnamese, Vietnamese",fr_FR:"French",de_DE:"German",sl_SI:"Slovenian, Slovenina"},application:{categories:{development:{label:"LBL_APP_CAT_DEVELOPMENT",icon:"applications-development"},science:{label:"LBL_APP_CAT_SCIENCE",icon:"applications-science"},games:{label:"LBL_APP_CAT_GAMES",icon:"applications-games"},graphics:{label:"LBL_APP_CAT_GRAPHICS",icon:"applications-graphics"},network:{label:"LBL_APP_CAT_NETWORK",icon:"applications-internet"},multimedia:{label:"LBL_APP_CAT_MULTIMEDIA",icon:"applications-multimedia"},office:{label:"LBL_APP_CAT_OFFICE",icon:"applications-office"},system:{label:"LBL_APP_CAT_SYSTEM",icon:"applications-system"},utilities:{label:"LBL_APP_CAT_UTILITIES",icon:"applications-utilities"},other:{label:"LBL_APP_CAT_OTHER",icon:"applications-other"}}},auth:{ui:{},login:{username:null,password:null}},settings:{lock:[],defaults:{"osjs/session":[],"osjs/desktop":{},"osjs/locale":{}}},search:{enabled:!0},notifications:{native:!1},desktop:{lock:!1,contextmenu:{enabled:!0,defaults:!0},settings:{font:"Roboto",theme:"StandardTheme",sounds:"FreedesktopSounds",icons:"GnomeIcons",animations:!1,panels:[{position:"top",items:[{name:"menu"},{name:"windows"},{name:"tray"},{name:"clock"}]}],widgets:[],keybindings:[],background:{src:n(31),color:"#572a79",style:"cover"},iconview:{enabled:!1}}},locale:{language:it("en_EN"),format:{shortDate:"yyyy-mm-dd",mediumDate:"dS mmm yyyy",longDate:"dS mmmm yyyy",fullDate:"dddd dS mmmm yyyy",shortTime:"HH:MM",longTime:"HH:MM:ss"}},windows:{template:null},vfs:{defaultPath:"osjs:/",defaultAdapter:"system",adapters:{},mountpoints:[{name:"apps",label:"Applications",adapter:"apps",icon:n(14),attributes:{visibility:"restricted",readOnly:!0}},{name:"osjs",label:"OS.js",adapter:"system",icon:{name:"folder-publicshare"}},{name:"home",label:"Home",adapter:"system",icon:{name:"user-home"}}],icons:{"^application/zip":{name:"package-x-generic"},"^application/javascript":{name:"text-x-script"},"^application/json":{name:"text-x-script"},"^application/x-python":{name:"text-x-script"},"^application/php":{name:"text-x-script"},"^application/pdf":{name:"x-office-document"},"^text/css":{name:"text-x-script"},"^text/html":{name:"text-html"},"^text/xml":{name:"text-html"},"^application":{name:"application-x-executable"},"^text":{name:"text-x-generic"},"^audio":{name:"audio-x-generic"},"^video":{name:"video-x-generic"},"^image":{name:"image-x-generic"}}},providers:{globalBlacklist:["osjs/websocket","osjs/clipboard","osjs/gapi"],globalWhitelist:[]}},dt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d()(this,e),r=Object.assign({},{classNames:["osjs-root"],root:document.body},r||{}),(n=v()(this,g()(e).call(this,ft,t,r))).user=null,n.ws=null,n.connected=!1,n.reconnecting=!1,n.ping=null,n.$root=r.root,n.$resourceRoot=r.resourceRoot||document.querySelector("head"),n.options.classNames.forEach(function(t){return n.$root.classList.add(t)});var o=n.configuration.ws.uri;if(!n.configuration.ws.uri.match(/^wss?:/)){var i=window.location,s=i.protocol,a=i.host;n.configuration.ws.uri=s.replace(/^http/,"ws")+"//"+a+o.replace(/^\/+/,"/")}return n}return b()(e,t),p()(e,[{key:"destroy",value:function(){this.destroyed||(this.emit("osjs/core:destroy"),this.ping=clearInterval(this.ping),X.destroyAll(),this.ws&&this.ws.close(),this.user=null,this.ws=null,this.connected=!1,this.connecting=!1,this.reconnecting=!1,this.ping=null,_()(g()(e.prototype),"destroy",this).call(this))}},{key:"boot",value:function(){var t=this,n=function(e){return e&&console.error(e),console.groupEnd(),t.start()};return this.booted?Promise.resolve(!1):(console.group("Core::boot()"),this.on("osjs/core:started",function(){t.has("osjs/sounds")&&t.make("osjs/sounds").play("service-login")}),this.on("osjs/core:destroy",function(){t.has("osjs/sounds")&&t.make("osjs/sounds").play("service-logout")}),_()(g()(e.prototype),"boot",this).call(this).then(function(){return t.has("osjs/auth")?t.make("osjs/auth").show(function(e){t.user=e,t.has("osjs/settings")?t.make("osjs/settings").load().then(function(){return n()}).catch(function(){return n()}):n()}):(console.warn("OS.js STARTED WITHOUT ANY AUTHENTICATION"),n())}).catch(n))}},{key:"start",value:function(){var t=this,n=function(t){return t&&console.warn(t),console.groupEnd(),!!t};return this.started?Promise.resolve():(console.group("Core::start()"),this.emit("osjs/core:start"),this.on("osjs/core:connected",function(e){var n=e.cookie.maxAge/2;t.ping=setInterval(function(){t.connected&&!t.reconnecting&&t.request("/ping").catch(function(t){return console.warn(t)})},n)}),this._createListeners(),_()(g()(e.prototype),"start",this).call(this).then(function(e){return console.groupEnd(),!!e&&new Promise(function(e,n){t._createConnection(function(t){return t?n(t):e()})||n("Already connecting...")}).then(function(){t.emit("osjs/core:started"),n()}).catch(function(e){console.warn(e),t.emit("osjs/core:started"),n()})}).catch(n))}},{key:"_createConnection",value:function(t){var e=this;if(t=t||function(){},this.configuration.standalone||this.connected)return!1;var n=this.config("ws").uri;return console.log("Creating websocket connection on",n),this.ws=new WebSocket(n),this.ws.onopen=function(n){var r=!!e.reconnecting;clearInterval(e.reconnecting),e.connected=!0,e.reconnecting=!1,setTimeout(function(){return t()},100),e.emit("osjs/core:connect",n,r)},this.ws.onclose=function(n){e.connected&&(e.reconnecting=setInterval(function(){return e._createConnection()},5e3)),e.connected=!1,t(new Error("Connection closed")),e.emit("osjs/core:disconnect",n)},this.ws.onmessage=function(t){try{var n=JSON.parse(t.data),r=n.params||[];console.debug("WebSocket message",n),e.emit.apply(e,[n.name].concat(l()(r)))}catch(t){console.warn(t)}},!0}},{key:"_createListeners",value:function(){window.addEventListener("message",function(t){var e=t.data||{};if(e&&e.pid>=0){var n=X.getApplications().find(function(t){return t.pid===e.pid});if(n)return console.debug("Routing message",e),void n.emit.apply(n,["message"].concat(l()(e.args)))}})}},{key:"url",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.configuration,o=r.http,i=r.ws;if("string"!=typeof t)return o.public;if(t.match(/^(http|ws|ftp)s?:/i))return t;var s=Object.assign({},{type:null,prefix:"websocket"===e.type},e),a=s.type,u=s.prefix,c="websocket"===a?i.uri:o.uri,l=t.replace(/^\/+/,"");if(n.type){var f=t.replace(/^\/?/,"/"),d="theme"===n.type?"themes":"icons"===n.type?"icons":"apps";l="".concat(d,"/").concat(n.name).concat(f)}return u?c+l:o.public.replace(/^\/?/,"/")+l}},{key:"request",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.has("osjs/locale")?this.make("osjs/locale").translate:function(t){return t};return this.config("standalone")?Promise.reject(new Error(r("ERR_REQUEST_STANDALONE"))):(t.match(/^((http|ws|ftp)s?:)?/i)||(t=this.url(t)),V(t,e,n).catch(function(t){throw new Error(r("ERR_REQUEST_NOT_OK",t))}))}},{key:"run",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return console.log("Core::run()",t,e,n),this.make("osjs/packages").launch(t,e,n)}},{key:"open",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.make("osjs/locale").translate,o=function(r){return e.run(r,{file:t},n)};if("osjs/application"===t.mime)return this.run(t.path.split("/").pop());var i=this.make("osjs/packages").getCompatiblePackages(t.mime);if(i.length>0){if(i.length>1)try{return this.make("osjs/dialog","choice",{title:r("LBL_LAUNCH_SELECT"),message:r("LBL_LAUNCH_SELECT_MESSAGE",t.path),choices:i.reduce(function(t,e){return Object.assign(t,u()({},e.name,e.name))},{})},function(t,e){"ok"===t&&e&&o(e)}),!0}catch(t){console.warn(t)}return o(i[0].name),Promise.resolve(!0)}return Promise.reject(!1)}},{key:"off",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.match(/^osjs\//)&&"function"!=typeof n)throw new TypeError("The callback must be a function");return _()(g()(e.prototype),"off",this).call(this,t,n,r)}},{key:"getUser",value:function(){return Object.assign({},this.user)}}]),e}(Q.CoreBase);function ht(t,e){for(var n=[],r=[],o=arguments.length;o-- >2;)n.push(arguments[o]);for(;n.length;){var i=n.pop();if(i&&i.pop)for(o=i.length;o--;)n.push(i[o]);else null!=i&&!0!==i&&!1!==i&&r.push(i)}return"function"==typeof t?t(e||{},r):{nodeName:t,attributes:e||{},children:r,key:e&&e.key}}function pt(t,e,n,r){var o,i=[].map,s=r&&r.children[0]||null,a=s&&function t(e){return{nodeName:e.nodeName.toLowerCase(),attributes:{},children:i.call(e.childNodes,function(e){return 3===e.nodeType?e.nodeValue:t(e)})}}(s),u=[],c=!0,l=m(t),f=function t(e,n,r){for(var o in r)"function"==typeof r[o]?function(t,o){r[t]=function(t){var i=o(t);return"function"==typeof i&&(i=i(L(e,l),r)),i&&i!==(n=L(e,l))&&!i.then&&p(l=v(e,m(n,i),l)),i}}(o,r[o]):t(e.concat(o),n[o]=m(n[o]),r[o]=m(r[o]));return r}([],l,m(e));return p(),f;function d(t){return"function"==typeof t?d(t(l,f)):null!=t?t:""}function h(){o=!o;var t=d(n);for(r&&!o&&(s=function t(e,n,r,o,i){if(o===r);else if(null==r||r.nodeName!==o.nodeName){var s=function t(e,n){var r="string"==typeof e||"number"==typeof e?document.createTextNode(e):(n=n||"svg"===e.nodeName)?document.createElementNS("http://www.w3.org/2000/svg",e.nodeName):document.createElement(e.nodeName);var o=e.attributes;if(o){o.oncreate&&u.push(function(){o.oncreate(r)});for(var i=0;i<e.children.length;i++)r.appendChild(t(e.children[i]=d(e.children[i]),n));for(var s in o)_(r,s,o[s],null,n)}return r}(o,i);e.insertBefore(s,n),null!=r&&E(e,n,r),n=s}else if(null==r.nodeName)n.nodeValue=o;else{!function(t,e,n,r){for(var o in m(e,n))n[o]!==("value"===o||"checked"===o?t[o]:e[o])&&_(t,o,n[o],e[o],r);var i=c?n.oncreate:n.onupdate;i&&u.push(function(){i(t,e)})}(n,r.attributes,o.attributes,i=i||"svg"===o.nodeName);for(var a={},l={},f=[],h=r.children,p=o.children,v=0;v<h.length;v++){f[v]=n.childNodes[v];var L=g(h[v]);null!=L&&(a[L]=[f[v],h[v]])}for(var v=0,y=0;y<p.length;){var L=g(h[v]),b=g(p[y]=d(p[y]));if(l[L])v++;else if(null==b||b!==g(h[v+1]))if(null==b||c)null==L&&(t(n,f[v],h[v],p[y],i),y++),v++;else{var O=a[b]||[];L===b?(t(n,O[0],O[1],p[y],i),v++):O[0]?t(n,n.insertBefore(O[0],f[v]),O[1],p[y],i):t(n,f[v],null,p[y],i),l[b]=p[y],y++}else null==L&&E(n,f[v],h[v]),v++}for(;v<h.length;)null==g(h[v])&&E(n,f[v],h[v]),v++;for(var v in a)l[v]||E(n,a[v][0],a[v][1])}return n}(r,s,a,a=t)),c=!1;u.length;)u.pop()()}function p(){o||(o=!0,setTimeout(h))}function m(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n}function v(t,e,n){var r={};return t.length?(r[t[0]]=t.length>1?v(t.slice(1),e,n[t[0]]):e,m(n,r)):e}function L(t,e){for(var n=0;n<t.length;)e=e[t[n++]];return e}function g(t){return t?t.key:null}function y(t){return t.currentTarget.events[t.type](t)}function _(t,e,n,r,o){if("key"===e);else if("style"===e)if("string"==typeof n)t.style.cssText=n;else for(var i in"string"==typeof r&&(r=t.style.cssText=""),m(r,n)){var s=null==n||null==n[i]?"":n[i];"-"===i[0]?t.style.setProperty(i,s):t.style[i]=s}else"o"===e[0]&&"n"===e[1]?(e=e.slice(2),t.events?r||(r=t.events[e]):t.events={},t.events[e]=n,n?r||t.addEventListener(e,y):t.removeEventListener(e,y)):e in t&&"list"!==e&&"type"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!o?t[e]=null==n?"":n:null!=n&&!1!==n&&t.setAttribute(e,n),null!=n&&!1!==n||t.removeAttribute(e)}function E(t,e,n){function r(){t.removeChild(function t(e,n){var r=n.attributes;if(r){for(var o=0;o<n.children.length;o++)t(e.childNodes[o],n.children[o]);r.ondestroy&&r.ondestroy(e)}return e}(e,n))}var o=n.attributes&&n.attributes.onremove;o?o(e,r):r()}}var mt=function(){function t(e){d()(this,t),this.core=e,this.$element=document.createElement("div"),this.app=null,this.focusLastWindow=null}return p()(t,[{key:"destroy",value:function(){}},{key:"init",value:function(){var t=this,e=this.core.make("osjs/theme").icon,n=this.core.make("osjs/locale").translate;this.core.make("osjs/tray").create({title:n("LBL_SEARCH_TOOLTOP","F3"),icon:e("system-search.png")},function(e){return t.show()}),this.$element.className="osjs-search",this.core.$root.appendChild(this.$element),this.createApp()}},{key:"search",value:function(t){var e=this.core.make("osjs/vfs"),n=this.core.make("osjs/fs").mountpoints().map(function(t){return"".concat(t.name,":/")}).map(function(n){return e.search({path:n},t).catch(function(t){return console.warn(t),[]})});return Promise.all(n).then(function(t){var e;return(e=[]).concat.apply(e,l()(t))})}},{key:"createApp",value:function(){var t=this,e=this.core.make("osjs/fs"),n=this.core.make("osjs/theme").icon,r=this.core.make("osjs/locale").translate;this.searchUI=pt({query:"",index:-1,status:void 0,error:null,visible:!1,results:[]},{search:function(e){return function(n,o){return t.search(e).then(function(t){return o.setResults(t)}).catch(function(t){return o.setError(t)}),{status:r("LBL_SEARCH_WAIT")}}},open:function(e){return function(n,r){var o=n.results[e];o&&t.core.open(o),r.toggle(!1)}},resetIndex:function(){return function(){return{index:-1}}},setNextIndex:function(){return function(t){return{index:(t.index+1)%t.results.length}}},setPreviousIndex:function(){return function(t){return{index:t.index<=0?t.results.length-1:t.index-1}}},setError:function(t){return function(){return{error:t,status:void 0,index:-1}}},setResults:function(t){return function(){return{results:t,index:-1,status:r("LBL_SEARCH_RESULT",t.length)}}},setQuery:function(t){return function(){return{query:t}}},toggle:function(t){return function(e){return{query:"",results:[],index:-1,status:void 0,error:null,visible:"boolean"==typeof t?t:!e.visible}}}},function(o,i){return ht("div",{class:"osjs-search-container osjs-notification",style:{display:o.visible?void 0:"none"}},[ht("input",{type:"text",placeholder:r("LBL_SEARCH_PLACEHOLDER"),class:"osjs-search-input",value:o.query,onblur:function(){return i.toggle(!1)},oninput:function(t){return i.setQuery(t.target.value)},onkeydown:function(e){38===e.keyCode?i.setPreviousIndex():40===e.keyCode?i.setNextIndex():27===e.keyCode&&(i.resetIndex(),-1===o.index&&t.hide())},onkeypress:function(t){13===t.keyCode&&(o.index>=0?i.open(o.index):i.search(o.query.replace(/\*?$/,"*").replace(/^\*?/,"*")))}}),ht("div",{"data-error":!!o.error,class:"osjs-search-message",style:{display:o.error||o.status?"block":"none"}},o.error||o.status),ht("ol",{class:"osjs-search-results",style:{display:o.results.length?void 0:"none"}},function(t,r){var o=t.results,i=t.index;return o.map(function(t,o){return ht("li",{onclick:function(){return r.open(o)},onupdate:function(t){o===i&&t.scrollIntoView()},class:["osjs-search-result",i===o?"osjs__active":""].join(" ")},[ht("img",{src:n(e.icon(t).name+".png")}),ht("span",{},"".concat(t.path," (").concat(t.mime,")"))])})}(o,i))])},this.$element)}},{key:"focus",value:function(){var t=this.$element.querySelector(".osjs-search-input");t&&t.focus()}},{key:"hide",value:function(){if(this.searchUI){this.searchUI.toggle(!1);var t=U.lastWindow();this.focusLastWindow&&t&&t.focus()}}},{key:"show",value:function(){var t=this;if(this.searchUI){var e=U.lastWindow();this.focusLastWindow=e&&e.blur(),this.searchUI.toggle(!0),setTimeout(function(){return t.focus()},1)}}}]),t}(),vt=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===Lt}(t)}(t)};var Lt="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function gt(t,e){return!1!==e.clone&&e.isMergeableObject(t)?_t(function(t){return Array.isArray(t)?[]:{}}(t),t,e):t}function yt(t,e,n){return t.concat(e).map(function(t){return gt(t,n)})}function _t(t,e,n){(n=n||{}).arrayMerge=n.arrayMerge||yt,n.isMergeableObject=n.isMergeableObject||vt;var r=Array.isArray(e);return r===Array.isArray(t)?r?n.arrayMerge(t,e,n):function(t,e,n){var r={};return n.isMergeableObject(t)&&Object.keys(t).forEach(function(e){r[e]=gt(t[e],n)}),Object.keys(e).forEach(function(o){n.isMergeableObject(e[o])&&t[o]?r[o]=_t(t[o],e[o],n):r[o]=gt(e[o],n)}),r}(t,e,n):gt(e,n)}_t.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,n){return _t(t,n,e)},{})};var Et=_t,bt=function(t){function e(t,n){var r;return d()(this,e),(r=v()(this,g()(e).call(this,"Desktop"))).core=t,r.options=Object.assign({contextmenu:[]},n),r.$theme=[],r.$icons=[],r.$styles=document.createElement("style"),r.$styles.setAttribute("type","text/css"),r.contextmenuEntries=[],r.search=t.config("search.enabled")?new mt(t):null,r.subtract={left:0,top:0,right:0,bottom:0},r}return b()(e,t),p()(e,[{key:"destroy",value:function(){this.search&&(this.search=this.search.destroy()),this.$styles&&this.$styles.parentNode&&this.$styles.remove(),this.$styles=null,this._removeIcons(),this._removeTheme()}},{key:"init",value:function(){var t=this;this.core.on("osjs/panel:create",function(e){t.subtract[e.options.position]+=e.$element.offsetHeight,t._updateCSS(),t.core.emit("osjs/desktop:transform",t.getRect())}),this.core.on("osjs/panel:destroy",function(e){t.subtract[e.options.position]-=e.$element.offsetHeight,t._updateCSS(),t.core.emit("osjs/desktop:transform",t.getRect())}),this.core.on("osjs/core:disconnect",function(e){console.warn("Connection closed",e);var n=t.core.make("osjs/locale").translate;t.core.make("osjs/notification",{title:n("LBL_CONNECTION_LOST"),message:n("LBL_CONNECTION_LOST_MESSAGE")})}),this.core.on("osjs/core:connect",function(e,n){if(console.info("Connection opened"),n){var r=t.core.make("osjs/locale").translate;t.core.make("osjs/notification",{title:r("LBL_CONNECTION_RESTORED"),message:r("LBL_CONNECTION_RESTORED_MESSAGE")})}}),this.core.on("osjs/window:transitionend",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.emit.apply(t,["theme:window:transitionend"].concat(n))}),this.core.on("osjs/window:change",function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.emit.apply(t,["theme:window:change"].concat(n))});var e=this.core.make("osjs/tray").create({title:"OS.js developer tools"},function(e){return t.onDeveloperMenu(e)});this.core.on("destroy",function(){return e.destroy()}),this.core.$root.addEventListener("touchmove",function(t){return t.preventDefault()}),this.core.$root.addEventListener("dragover",function(t){t.preventDefault()}),this.core.$root.addEventListener("drop",function(t){t.preventDefault()});["keydown","keyup","keypress"].forEach(function(e){t.core.$root.addEventListener(e,function(t){return function(t,e){var n=U.lastWindow();(function(t){return t&&!t.getState("minimized")&&t.getState("focused")})(n)&&n.emit(t,e,n)}(e,t)})}),this.core.$root.addEventListener("keydown",function(e){if(e.target)if(114===e.keyCode)e.preventDefault(),t.search&&t.search.show();else if(9===e.keyCode){var n=e.target.tagName,r=-1!==["INPUT","TEXTAREA","SELECT","BUTTON"].indexOf(n);!function(t,e){return t&&t.$element.contains(e)}(U.lastWindow(),e.target)?e.preventDefault():r?"TEXTAREA"===n&&function(t){var e=t.target,n=e.selectionStart,r=e.selectionEnd,o=e.value;e.value=o.substring(0,n)+"\t"+o.substring(r,o.length),n++,e.selectionStart=n,e.selectionEnd=n}(e):e.preventDefault()}}),this.core.$root.addEventListener("contextmenu",function(e){e.target===t.core.$root&&t.onContextMenu(e)}),this.core.$resourceRoot.appendChild(this.$styles)}},{key:"start",value:function(){this.search&&this.search.init()}},{key:"_updateCSS",value:function(){this.$styles&&(this.$styles.innerHTML=function(t){return"\n  .osjs-window[data-maximized=true] {\n    top: ".concat(t.top,"px !important;\n    left: ").concat(t.left,"px !important;\n    right: ").concat(t.right,"px !important;\n    bottom: ").concat(t.bottom,"px !important;\n    width: calc(100% -  ").concat(t.left+t.right,"px) !important;\n    height: calc(100% - ").concat(t.top+t.bottom,"px) !important;\n  }\n")}(this.subtract))}},{key:"addContextMenu",value:function(t){this.contextmenuEntries=this.contextmenuEntries.concat(t)}},{key:"applySettings",value:function(t){var e,n=this,r=this.core.config("desktop.lock"),o=this.core.config("desktop.settings");if(r)e=o;else{var i=t||this.core.make("osjs/settings").get("osjs/desktop");e=Et(o,i,{arrayMerge:function(t,e){return e}})}var s=function(t,e){if(n.core.has(t)){var r=n.core.make(t);r.removeAll(),e.forEach(function(t){return r.create(t)})}};return function(t){var e=t.font,r=t.background;n.core.$root.style.fontFamily="".concat(e,", sans-serif"),function(t,e){var n=t.$root,r={backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%",backgroundSize:"auto",backgroundColor:e.color,backgroundImage:"none"};"cover"===e.style||"contain"===e.style?r.backgroundSize=e.style:"repeat"===e.style&&(r.backgroundRepeat="repeat"),"color"!==e.style&&e.src&&("string"==typeof e.src?r.backgroundImage="url(".concat(e.src,")"):t.make("osjs/vfs").url(e.src).then(function(t){setTimeout(function(){return n.style.backgroundImage="url(".concat(t,")")},1)}).catch(function(t){return console.warn(t)})),Object.keys(r).forEach(function(t){return n.style[t]=r[t]})}(n.core,r)}(e),s("osjs/panels",e.panels),s("osjs/widgets",e.widgets),this.applyTheme(e.theme),this.applyIcons(e.icons),Object.assign({},e)}},{key:"_removeTheme",value:function(){this.emit("theme:destroy"),this.off(["theme:init","theme:destroy","theme:window:change","theme:window:transitionend"]),this.$theme.forEach(function(t){t&&t.parentNode&&t.remove()}),this.$theme=[]}},{key:"_removeIcons",value:function(){this.$icons.forEach(function(t){t&&t.parentNode&&t.remove()}),this.$icons=[]}},{key:"applyIcons",value:function(t){var e=this;return t=t||this.core.config("desktop.icons"),this._applyTheme(t).then(function(t){var n=t.elements;t.errors,t.callback,t.metadata;e._removeIcons(),e.$icons=Object.values(n),e.emit("icons:init")})}},{key:"applyTheme",value:function(t){var e=this;return t=t||this.core.config("desktop.theme"),this._applyTheme(t).then(function(t){var n=t.elements,r=(t.errors,t.callback),o=t.metadata;if(e._removeTheme(),r&&o)try{r(e.core,e,{},o)}catch(t){console.warn(t)}e.$theme=Object.values(n),e.emit("theme:init")})}},{key:"_applyTheme",value:function(t,e){return this.core.make("osjs/packages").launch(t).then(function(t){return t.errors.length&&console.error(t.errors),t})}},{key:"_applySettingsByKey",value:function(t,e){var n=this;return this.core.make("osjs/settings").set("osjs/desktop",t,e).save().then(function(){return n.applySettings()})}},{key:"onDeveloperMenu",value:function(t){var e=this,n=this.core.make("osjs/locale").translate,r=this.core.make("osjs/settings").get(),o=Object.keys(r).map(function(t){return{label:t,onclick:function(){e.core.make("osjs/settings").clear(t).then(function(){return e.applySettings()})}}});this.core.make("osjs/contextmenu").show({position:t,menu:[{label:n("LBL_KILL_ALL"),onclick:function(){return X.destroyAll()}},{label:n("LBL_APPLICATIONS"),items:X.getApplications().map(function(t){return{label:"".concat(t.metadata.name," (").concat(t.pid,")"),items:[{label:n("LBL_KILL"),onclick:function(){return t.destroy()}},{label:n("LBL_RELOAD"),onclick:function(){return t.relaunch()}}]}})},{label:"Clear Storage",items:o}]})}},{key:"onContextMenu",value:function(t){var e,n=this,r=this.core.config("desktop.lock"),o=(e=[]).concat.apply(e,l()(this.contextmenuEntries.map(function(t){return"function"==typeof t?t():t}))),i=this.core.config("desktop.contextmenu");if(!1!==i&&!1!==i.enabled){var s=!0===i||i.defaults,a=this.core.make("osjs/locale").translate,u=this.core.make("osjs/packages").getPackages(function(t){return"theme"===t.type}),c=r?[]:[{label:a("LBL_DESKTOP_SELECT_WALLPAPER"),onclick:function(){n.core.make("osjs/dialog","file",{mime:["^image"]},function(t,e){"ok"===t&&n._applySettingsByKey("background.src",e)})}},{label:a("LBL_DESKTOP_SELECT_THEME"),items:u.map(function(t){return{label:t.name,onclick:function(){n._applySettingsByKey("theme",t.name)}}})}],f="function"===s?i.defaults(this,c):s?c:[],d="function"==typeof this.options.contextmenu?this.options.contextmenu(this,c):this.options.contextmenu||[],h=l()(f).concat(l()(d),l()(o));h.length&&this.core.make("osjs/contextmenu").show({menu:h,position:t})}}},{key:"getRect",value:function(){var t=this.core.$root,e=this.subtract,n=e.left,r=e.top,o=e.right,i=e.bottom;return{width:t.offsetWidth-n-o,height:t.offsetHeight-r-i,top:r,bottom:i,left:n,right:o}}}]),e}(w.EventEmitter),Ot="Notification"in window,At=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};d()(this,t);var o=e.make("osjs/locale").translate("LBL_NOTIFICATION");this.core=e,this.$root=n,this.$element=document.createElement("div"),this.destroyed=!1,this.options=Object.assign({icon:null,title:o,message:o,timeout:5e3,native:e.config("notifications.native",!1)},r),this.core.emit("osjs/notification:create",this)}return p()(t,[{key:"destroy",value:function(){this.destroyed||(this.destroyed=!0,this.core.emit("osjs/notification:destroy",this),this.$element.remove(),this.$element=null,this.$root=null)}},{key:"render",value:function(){var t=this,e=function(){return t.destroy()},n=function(){t.$element.classList.add("osjs-notification"),t.options.timeout&&setTimeout(function(){return t.destroy()},t.options.timeout),t.$element.addEventListener("click",e),t.$root.appendChild(t.$element),pt(t.options,{},function(t){return ht("div",{class:"osjs-notification-wrapper","data-has-icon":!!t.icon,style:{backgroundImage:t.icon?"url(".concat(t.icon,")"):void 0}},[ht("div",{class:"osjs-notification-title"},t.title),ht("div",{class:"osjs-notification-message"},t.message)])},t.$element)};this.options.native?function(t,e){var n=window.Notification,r=function(){var r=new n(t.title,{body:t.message,icon:t.icon});return r.onclick=e,r};if(Ot){if("granted"===n.permission)return Promise.resolve(r());if("denied"!==n.permission)return new Promise(function(t,e){n.requestPermission(function(n){return"granted"===n?t(!0):e(n)})}).then(r)}return Promise.reject("Unsupported")}(this.options,e).catch(function(t){console.warn(t),n()}):n()}}]),t}(),wt=n(21),Tt=N(),St=!!Tt&&{passive:!0},Bt={maximize:function(t){return t.maximize()?null:t.restore()},minimize:function(t){return t.minimize()},close:function(t){return t.close()}},kt=function(t,e){var n=function(t){var e=t.attributes,n=e.maxDimension,r=e.minDimension,o=t.state,i=o.position,s=o.dimension,a={left:i.left+s.width-r.width,top:i.top+s.height-r.height},u=function(t,e,n){var r=-1===t?n:Math.max(t,n);return-1===e?r:Math.min(e,r)};return function(t,e,o,i){return{width:u(r.width,n.width,t),height:u(r.height,n.height,e),top:u(-1,a.top,o),left:u(-1,a.left,i)}}}(t),r=t.state,o=r.position,i=r.dimension,s=e.getAttribute("data-direction").split(""),a=function(t){return-1!==s.indexOf(t)},u=a("e")?1:a("w")?-1:0,c=a("s")?1:a("n")?-1:0;return function(t,e){var r=i.width+t*u,s=i.height+e*c,a=-1===c?o.top+e:o.top,l=-1===u?o.left+t:o.left;return n(r,s,a,l)}},jt=function(t){var e=t.clientX,n=t.clientY,r=t.target,o=t.touches||t.changedTouches||[];return o.length&&(e=o[0].clientX,n=o[0].clientY),{clientX:e,clientY:n,touch:o.length>0,target:r}},Nt=function(t){return Object.keys(t.attributes.mediaQueries).filter(function(e){return wt.match(t.attributes.mediaQueries[e],{type:"screen",orientation:function(t){return t&&t.orientation?t.orientation.type:window.matchMedia("(orientation: portrait)")?"portrait":"landscape"}(window.screen),width:t.state.dimension.width,height:t.state.dimension.height})}).pop()},Pt=function(){function t(e){d()(this,t),this.core=e,this.lastAction=null}return p()(t,[{key:"init",value:function(t){var e=this,n=function(n){return e.mousedown(n,t)},r=function(n){return e.mousedown(n,t)},o=function(n){return e.click(n,t)},i=function(n){return e.dblclick(n,t)},s=function(n){t&&t.emit("transitionend"),e.core.emit("osjs/window:transitionend",n,t)};t.$element.addEventListener("touchstart",n,St),t.$element.addEventListener("mousedown",r),t.$element.addEventListener("click",o),t.$element.addEventListener("dblclick",i),t.$element.addEventListener("transitionend",s),t.on("destroy",function(){t.$element&&(t.$element.removeEventListener("touchstart",n,St),t.$element.removeEventListener("mousedown",r),t.$element.removeEventListener("click",o),t.$element.removeEventListener("dblclick",i),t.$element.removeEventListener("transitionend",s))});var a=this.core.has("osjs/desktop")?this.core.make("osjs/desktop").getRect():{top:0,left:0},u=function(t,e,n){var r=10+e.left,o=10+e.top,i=r+t.wid%20*10,s=o+t.wid%20*10;return{top:"number"==typeof n.top?Math.max(e.top,n.top):s,left:"number"==typeof n.left?Math.max(e.left,n.left):i}}(t,a,t.state.position),c=u.top,l=u.left;t.state.position.top=c,t.state.position.left=l,t.state.media=Nt(t)}},{key:"click",value:function(t,e){if(!this.lastAction&&t.target.classList.contains("osjs-window-button")){var n=t.target.getAttribute("data-action");Bt[n](e)}}},{key:"dblclick",value:function(t,e){this.lastAction||t.target.classList.contains("osjs-window-header")&&(e.state.maximized?e.restore():e.state.minimized?e.raise():e.maximize())}},{key:"mousedown",value:function(t,e){var n=this,r=!1,o=e.attributes,i=o.moveable,s=o.resizable,a=jt(t),u=a.clientX,c=a.clientY,l=a.touch,f=a.target,d=t.ctrlKey?e.$element.contains(f):f.classList.contains("osjs-window-header"),h=this.core.has("osjs/desktop")?this.core.make("osjs/desktop").getRect():{top:0,left:0},p=f.classList.contains("osjs-window-resize")?kt(e,f):null,m=d?function(t,e){var n=t.state.position;return function(t,r){return{top:Math.max(n.top+r,e.top),left:n.left+t}}}(e,h):null,v=function(t){if(Tt||t.preventDefault(),!(!i&&m||!s&&p)){var o=jt(t),a=p?Math.max(h.left,o.clientX):o.clientX,l=p?Math.max(h.top,o.clientY):o.clientY,f=a-u,d=l-c;if(p){var v=p(f,d),L=v.width,g=v.height,y=v.top,_=v.left;e._setState("dimension",{width:L,height:g},!1),e._setState("position",{top:y,left:_},!1),n.lastAction="resize"}else if(m){var E=m(f,d);e._setState("position",E,!1),n.lastAction="move"}n.lastAction&&(e._setState("move"===n.lastAction?"moving":"resizing",!0),r||(n.core.$root.setAttribute("data-window-action",String(!0)),r=!0))}},L=function t(){l?(document.removeEventListener("touchmove",v,St),document.removeEventListener("touchend",t,St)):(document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",t)),e._setState("media",Nt(e),!1),"move"===n.lastAction?(e.emit("moved",Object.assign({},e.state.position),e),e._setState("moving",!1)):"resize"===n.lastAction&&(e.emit("resized",Object.assign({},e.state.dimension),e),e._setState("resizing",!1)),n.core.$root.setAttribute("data-window-action",String(!1))};e.focus()||e.setNextZindex(),(m||p)&&(l?(document.addEventListener("touchmove",v,St),document.addEventListener("touchend",L,St)):(document.addEventListener("mousemove",v),document.addEventListener("mouseup",L))),this.lastAction=null,this.core.has("osjs/contextmenu")&&this.core.make("osjs/contextmenu").hide()}}]),t}(),Rt=function(t,e,n){return e.map(function(e){return ht("div",{class:"osjs-login-field osjs-login-field-"+e.tagName},ht(e.tagName,function(t,e,n){return n=n?"disabled":void 0,"input"===e.tagName&&"submit"!==e.attributes.type?Object.assign({},{autocapitalize:"off",autocomplete:"new-"+e.attributes.name,disabled:n,oncreate:function(n){return n.value=t[e.attributes.name]||e.value||""}},e.attributes):Object.assign({disabled:n},e.attributes)}(t,e,n),function(t){return"select"===t.tagName&&t.choices?t.choices.map(function(t){return ht("option",{current:t.current?"current":void 0,value:t.value},t.label)}):[]}(e)))})},Ct=function(t){function e(t,n){var r;return d()(this,e),(r=v()(this,g()(e).call(this,"Login"))).$container=null,r.core=t,r.options=Object.assign({id:"osjs-login",title:"Welcome to OS.js",stamp:t.config("version"),logo:{position:"top",src:null},fields:[{tagName:"input",attributes:{name:"username",type:"text",placeholder:"Username"}},{tagName:"input",attributes:{name:"password",type:"password",placeholder:"Password"}},{tagName:"input",attributes:{type:"submit",value:"Login"}}]},n),r}return b()(e,t),p()(e,[{key:"init",value:function(t){this.$container=document.createElement("div"),this.$container.id=this.options.id,this.$container.className="osjs-login-base",this.core.$root.classList.add("login"),this.core.$root.appendChild(this.$container),this.render(t)}},{key:"destroy",value:function(){this.core.$root.classList.remove("login"),this.$container&&this.$container.remove()}},{key:"render",value:function(t){var e=this,n=this.options.logo,r=n.src,o=n.position,i=this.core.config("auth.login",{}),s=function(){return ht("div",{class:"osjs-login-logo","data-position":o,style:{backgroundImage:"url('".concat(r,"')")}})},a=pt(Object.assign({hidden:t},i),{setLoading:function(t){return function(e){return{loading:t}}},setError:function(t){return function(e){return{error:t,hidden:!1}}},submit:function(t){return function(n){if(t.preventDefault(),!n.loading){var r=Array.from(t.target.elements).filter(function(t){return"submit"!==t.type}).reduce(function(t,e){return Object.assign(t,u()({},e.name,e.value))},{});e.emit("login:post",r)}}}},function(t,n){var i=[];e.options.title&&i.push(ht("div",{class:"osjs-login-header"},ht("span",{},e.options.title))),r&&-1!==["top","middle"].indexOf(o)&&i["top"===o?"unshift":"push"](s());var a=function(t){return o===t?ht("div",{"data-position":o},s()):null},u=function(t){var n=Rt(t,e.options.fields,t.loading);return r&&"bottom"===o&&n.push(s()),e.options.stamp&&n.push(ht("div",{class:"osjs-login-stamp"},e.options.stamp)),n}(t),c=i.concat([ht("div",{class:"osjs-login-error",style:{display:t.error?"block":"none"}},ht("span",{},t.error)),ht("form",{loading:!1,method:"post",action:"#",autocomplete:"off",onsubmit:n.submit},u)]);return ht("div",{class:"osjs-login",id:e.options.id,style:{display:t.hidden?"none":void 0}},[a("left"),ht("div",{class:"osjs-login-content"},c),a("right")].filter(function(t){return!!t}))},this.$container);this.on("login:start",function(){return a.setLoading(!0)}),this.on("login:stop",function(){return a.setLoading(!1)}),this.on("login:error",function(t){return a.setError(t)})}}]),e}(w.EventEmitter),It=n(13),xt=n.n(It),Mt=function(){function t(e){d()(this,t),this.core=e}return p()(t,[{key:"save",value:function(){var t=X.getApplications().filter(function(t){return!1!==t.options.sessionable}).map(function(t){return t.getSession()});return this.core.make("osjs/settings").set("osjs/session",null,t).save()}},{key:"load",value:function(){var t=this;arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&X.destroyAll();var e=this.core.make("osjs/settings").get("osjs/session");return!e||e instanceof Array||(e=Object.values(e)),e&&(console.group("Session::load()"),e.forEach(function(e){try{t.core.run(e.name,e.args,{restore:{windows:e.windows}})}catch(t){console.warn(t)}}),console.groupEnd()),Promise.resolve(!0)}}]),t}(),Dt=function(){function t(e){d()(this,t),this.core=e,this.packages=[],this.metadata=[],this.loaded=[],this.running=[]}return p()(t,[{key:"destroy",value:function(){this.packages=[],this.metadata=[]}},{key:"init",value:function(){var t=this;return console.debug("Packages::init()"),this.core.on("osjs/core:started",function(){t.metadata.filter(function(t){return!0===t.autostart}).forEach(function(e){return t.launch(e.name)})}),function(t){return fetch(t.url("/metadata.json")).then(function(t){return t.json()})}(this.core).then(function(e){t.metadata=e.map(function(t){return Object.assign({type:"application"},t)})})}},{key:"preload",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.core.$resourceRoot,o=function(t){return!n&&e.loaded.find(function(e){return e===t})},i=t.filter(function(t){return!o(t)}).map(function(t){return console.debug("Packages::preload()",t),(t.match(/\.js$/)?j(r,t):k(r,t)).then(function(e){return{success:!0,entry:t,el:e}}).catch(function(e){return{success:!1,entry:t,error:e}})});return Promise.all(i).then(function(t){var n=t.filter(function(t){return t.success});n.forEach(function(t){o(t)||e.loaded.push(t)});var r=t.filter(function(t){return!t.success});return r.forEach(function(t){return console.warn("Failed loading",t.entry,t.error)}),{errors:r.map(function(t){return t.entry}),elements:n.reduce(function(t,e){return Object.assign({},t,u()({},e.entry,e.el))},{})}})}},{key:"launch",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.debug("Packages::launch()",t,n,r);var o=!1,i=this.core.make("osjs/locale").translate,s=this.metadata.find(function(e){return e.name===t});if(!s)throw new Error(i("ERR_PACKAGE_NOT_FOUND",t));if(-1!==["theme","icons","sounds"].indexOf(s.type))return this._launchTheme(t,s.type);if(s.singleton){var a=X.getApplications().find(function(t){return t.metadata.name===s.name});if(a)return a.emit("attention",n,r),o=!0,Promise.resolve(a);if(this.running.filter(function(e){return e===t}).length>0)return new Promise(function(i,s){e.core.on("osjs/application:launched",function(e,s){o?i(s):e===t&&(s.emit("attention",n,r),i(s))})})}return this.core.emit("osjs/application:launch",t,n,r),this.running.push(t),this._launch(t,s,n,r)}},{key:"_launchTheme",value:function(t,e){var n=this,r=this.core.make("osjs/locale").translate,o=this.getPackages(function(t){return-1!==["theme","icons","sounds"].indexOf(t.type)}).find(function(e){return e.name===t});if(!o)throw new Error(r("ERR_PACKAGE_NOT_FOUND",t));var i=(o.files||[]).map(function(t){return n.core.url(t,{},Object.assign({type:e},o))});return this.preload(i).then(function(e){return Object.assign({elements:{}},e,n.packages.find(function(e){return e.metadata.name===t})||{})})}},{key:"_launch",value:function(t,e,n,r){var o=this,i=this.core.make("osjs/locale").translate,s=function(e){o.core.has("osjs/dialog")?o.core.make("osjs/dialog","alert",{type:"error",title:i("ERR_PACKAGE_EXCEPTION",t),message:i("ERR_PACKAGE_EXCEPTION",t),error:e},function(){}):alert("".concat(i("ERR_PACKAGE_EXCEPTION",t),": ").concat(e.stack||e))},a=function(e){throw o.core.emit("osjs/application:launched",t,!1),s(e),new Error(e)},u=e.files.map(function(t){return o.core.url(t,{},Object.assign({type:"apps"},e))});return this.preload(u,!0===r.forcePreload).then(function(e){var u=e.errors;u.length&&a(i("ERR_PACKAGE_LOAD",t,u.join(", ")));var c=o.packages.find(function(e){return e.metadata.name===t});return c||a(i("ERR_PACKAGE_NO_RUNTIME",t)),function(e){var i;try{console.group("Packages::_launch()"),(i=e.callback(o.core,n,r,e.metadata))instanceof X?i.on("destroy",function(){var e=o.running.findIndex(function(e){return e===t});-1!==e&&o.running.splice(e,1)}):console.warn("The application",t,"did not return an Application instance from registration")}catch(t){s(t),console.warn(t)}finally{o.core.emit("osjs/application:launched",t,i),console.groupEnd()}return i}(c)})}},{key:"register",value:function(t,e){console.info("Packages::register()",t);var n=this.core.make("osjs/locale").translate,r=this.metadata.find(function(e){return e.name===t});if(!r)throw new Error(n("ERR_PACKAGE_NO_METADATA",t));var o=this.packages.findIndex(function(e){return e.metadata.name===t});-1!==o&&this.packages.splice(o,1),this.packages.push({metadata:r,callback:e})}},{key:"getPackages",value:function(t){t=t||function(){return!0};var e=this.core.getUser();return this.metadata.map(function(t){return Object.assign({},t)}).filter(function(t){return!(t.groups instanceof Array)||t.groups.every(function(t){return-1!==e.groups.indexOf(t)})}).filter(function(t){return!(e.blacklist instanceof Array)||-1===e.blacklist.indexOf(t.name)}).filter(t)}},{key:"getCompatiblePackages",value:function(t){return this.getPackages(function(e){return!!e.mimes&&!!e.mimes.find(function(e){try{return new RegExp(e).test(t)}catch(t){console.warn(t)}return e===t})})}}]),t}(),Ft=function(){function t(e){d()(this,t),this.core=e,this.entries=[]}return p()(t,[{key:"destroy",value:function(){this.entries=[]}},{key:"create",value:function(t,e){var r=this,o=this.core.make("osjs/locale").translate("LBL_TRAY");e=e||function(){};var i=Object.assign({},{icon:n(14),title:o,onclick:e,oncontextmenu:e,handler:e},t);return console.debug("Created new tray entry",i),this.entries.push(i),this.core.emit("osjs/tray:create",i),this.core.emit("osjs/tray:update",this.entries),{entry:i,update:function(t){Object.keys(t).forEach(function(e){return i[e]=t[e]}),r.core.emit("osjs/tray:update",r.entries)},destroy:function(){return r.remove(i)}}}},{key:"remove",value:function(t){var e=this.entries.findIndex(function(e){return e===t});-1!==e&&(this.entries.splice(e,1),this.core.emit("osjs/tray:remove",t),this.core.emit("osjs/tray:update",this.entries))}}]),t}(),Ut=function(){function t(){d()(this,t),this.value=void 0,this.clear()}return p()(t,[{key:"destroy",value:function(){this.clear()}},{key:"clear",value:function(){this.value=Promise.resolve()}},{key:"set",value:function(t){this.value=t}},{key:"get",value:function(t){var e=this,n="function"==typeof this.value?n():n,r=function(n){return t&&e.clear(),n};return Promise.resolve(n).then(r).catch(r)}}]),t}(),Gt={ERR_REQUEST_STANDALONE:"Cannot make requests in standalone mode.",ERR_REQUEST_NOT_OK:"An error occured while performing a request: {0}",ERR_VFS_MOUNT_NOT_FOUND:"Filesystem '{0}' not found",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Filesystem not found for '{0}'",ERR_VFS_MOUNT_NOT_MOUNTED:"Filesystem '{0}' not mounted",ERR_VFS_MOUNT_ALREADY_MOUNTED:"Filesystem '{0}' already mounted",ERR_VFS_PATH_FORMAT_INVALID:"Given path '{0}' does not match 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Package Metadata '{0}' not found",ERR_PACKAGE_LOAD:"Package Loading '{0}' failed: {1}",ERR_PACKAGE_NO_RUNTIME:"Package Runtime '{0}' not found",ERR_PACKAGE_NO_METADATA:"Metadata not found for '{0}'. Is it in the manifest?",ERR_PACKAGE_EXCEPTION:"An exception occured in '{0}'",ERR_WINDOW_ID_EXISTS:"Window with ID '{0}' already exists",ERR_INVALID_LOCALE:"Invalid locale '{0}'",LBL_CONNECTION_LOST:"Connection Lost",LBL_CONNECTION_LOST_MESSAGE:"The connection to the OS.js was lost. Reconnecting....",LBL_CONNECTION_RESTORED:"Connection Restored",LBL_CONNECTION_RESTORED_MESSAGE:"The connection to the OS.js server was restored.",LBL_APP_CAT_DEVELOPMENT:"Development",LBL_APP_CAT_SCIENCE:"Science",LBL_APP_CAT_GAMES:"Games",LBL_APP_CAT_GRAPHICS:"Graphics",LBL_APP_CAT_NETWORK:"Network",LBL_APP_CAT_MULTIMEDIA:"Multimedia",LBL_APP_CAT_OFFICE:"Office",LBL_APP_CAT_SYSTEM:"System",LBL_APP_CAT_UTILITIES:"Utilities",LBL_APP_CAT_OTHER:"Other",LBL_LAUNCH_SELECT:"Select application",LBL_LAUNCH_SELECT_MESSAGE:"Select application for '{0}'",LBL_DESKTOP_SELECT_WALLPAPER:"Select wallpaper",LBL_DESKTOP_SELECT_THEME:"Select theme",LBL_SEARCH_TOOLTOP:"Search Filesystem ({0})",LBL_SEARCH_PLACEHOLDER:"Search filesystems...",LBL_SEARCH_WAIT:"Searching...",LBL_SEARCH_RESULT:"Showing {0} results",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"Top",LBL_LEFT:"Left",LBL_RIGHT:"Right",LBL_BOTTOM:"Bottom",LBL_MENU:"Menu",LBL_ERROR:"Error",LBL_INFO:"Info",LBL_MESSAGE:"Message",LBL_WARNINIG:"Warning",LBL_SUCCESS:"Success",LBL_FAILURE:"Failure",LBL_WINDOW:"Window",LBL_WINDOWS:"Windows",LBL_NOTIFICATION:"Notification",LBL_NOTIFICATIONS:"Notifications",LBL_TRAY:"Tray Entry",LBL_NAME:"Name",LBL_TYPE:"Type",LBL_SIZE:"Size",LBL_FILE:"File",LBL_NEW:"New",LBL_OPEN:"Open",LBL_SAVE:"Save",LBL_SAVEAS:"Save As",LBL_OK:"OK",LBL_ABORT:"Abort",LBL_CANCEL:"Cancel",LBL_CLOSE:"Close",LBL_QUIT:"Quit",LBL_YES:"Yes",LBL_NO:"No",LBL_GO:"Go",LBL_MKDIR:"Create new directory",LBL_MKFILE:"Create new file",LBL_COPY:"Copy",LBL_PASTE:"Paste",LBL_CUT:"Cut",LBL_MOVE:"Move",LBL_RENAME:"Rename",LBL_DELETE:"Delete",LBL_DOWNLOAD:"Download",LBL_REFRESH:"Refresh",LBL_RELOAD:"Reload",LBL_HOME:"Home",LBL_VIEW:"View",LBL_HELP:"Help",LBL_ABOUT:"About",LBL_APPLICATION:"Application",LBL_APPLICATIONS:"Applications",LBL_KILL:"Kill",LBL_KILL_ALL:"Kill all",LBL_MINIMIZE:"Minimize",LBL_MAXIMIZE:"Maximize",LBL_RESTORE:"Restore",LBL_RAISE:"Raise",LBL_SHADE:"Shade",LBL_UNSHADE:"Unshade",LBL_ONTOP:"On top",LBL_RESIZE:"Resize"},Ht={ERR_REQUEST_STANDALONE:"Impossible d'effectuer des requtes en mode autonome.",ERR_REQUEST_NOT_OK:"Une erreur s'est produite en excutant une requte : {0}",ERR_VFS_MOUNT_NOT_FOUND:"Systme de fichier '{0}' absent",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Systme de fichier pour '{0}' absent",ERR_VFS_MOUNT_NOT_MOUNTED:"Le systme de fichier '{0}' n'est pas encore mont",ERR_VFS_MOUNT_ALREADY_MOUNTED:"Le systme de fichier '{0}' est dj mont",ERR_VFS_PATH_FORMAT_INVALID:"Le dossier '{0}' ne correspond pas 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Les mtadonnes du paquet '{0}' n'ont pas t touves",ERR_PACKAGE_LOAD:"Le chargement du paquet '{0}' a chou: {1}",ERR_PACKAGE_NO_RUNTIME:"Dure d'excution du paquet '{0}' absente",ERR_PACKAGE_NO_METADATA:"Mtadonne absentes pour '{0}'. Sont-elles dans le manifeste ?",ERR_PACKAGE_EXCEPTION:"Une exception s'est produite dans '{0}'",ERR_WINDOW_ID_EXISTS:"La fntre avec l'identifiant '{0}' existe dj",ERR_INVALID_LOCALE:"Paramtre de langue invalide '{0}'",LBL_CONNECTION_LOST:"Connexion perdue",LBL_CONNECTION_LOST_MESSAGE:"La connexion  OS.js a t perdue. Reconnexion...",LBL_CONNECTION_RESTORED:"Connexion Restaure",LBL_CONNECTION_RESTORED_MESSAGE:"La connexion  OS.js a t restaure.",LBL_APP_CAT_DEVELOPMENT:"Dveloppement",LBL_APP_CAT_SCIENCE:"Science",LBL_APP_CAT_GAMES:"Jeux",LBL_APP_CAT_GRAPHICS:"Graphisme",LBL_APP_CAT_NETWORK:"Rseau",LBL_APP_CAT_MULTIMEDIA:"Multimdia",LBL_APP_CAT_OFFICE:"Bureautique",LBL_APP_CAT_SYSTEM:"Systme",LBL_APP_CAT_UTILITIES:"Utilitaires",LBL_APP_CAT_OTHER:"Autre",LBL_LAUNCH_SELECT:"Slectionner l'application",LBL_LAUNCH_SELECT_MESSAGE:"Slectionner l'application pour '{0}'",LBL_DESKTOP_SELECT_WALLPAPER:"Slectionner le fond d'cran",LBL_DESKTOP_SELECT_THEME:"Slectionner le thme",LBL_SEARCH_TOOLTOP:"Recherche d'un systme de fichier ({0})",LBL_SEARCH_PLACEHOLDER:"Recherche des systmes de fichiers...",LBL_SEARCH_WAIT:"Recherche...",LBL_SEARCH_RESULT:"Affichage des rsultats {0}",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"En Haut",LBL_LEFT:" Gauche",LBL_RIGHT:" Droite",LBL_BOTTOM:"En Bas",LBL_MENU:"Menu",LBL_ERROR:"Erreur",LBL_INFO:"Info",LBL_MESSAGE:"Message",LBL_WARNINIG:"Attention",LBL_SUCCESS:"Succs",LBL_FAILURE:"chec",LBL_WINDOW:"Fentre",LBL_WINDOWS:"Fentres",LBL_NOTIFICATION:"Notification",LBL_NOTIFICATIONS:"Notifications",LBL_TRAY:"Accs au plateau",LBL_NAME:"Nom",LBL_TYPE:"Type",LBL_SIZE:"Taille",LBL_FILE:"Fichier",LBL_NEW:"Nouveau",LBL_OPEN:"Ouvrir",LBL_SAVE:"Sauvegarder",LBL_SAVEAS:"Sauvegarder comme",LBL_OK:"OK",LBL_ABORT:"Abandonner",LBL_CANCEL:"Annuler",LBL_CLOSE:"Fermer",LBL_QUIT:"Quitter",LBL_YES:"Oui",LBL_NO:"Non",LBL_GO:"C'est parti !",LBL_MKDIR:"Crer nouveau dossier",LBL_MKFILE:"Crer nouveau fichier",LBL_COPY:"Copier",LBL_PASTE:"Coller",LBL_CUT:"Couper",LBL_MOVE:"Dplacer",LBL_RENAME:"Renommer",LBL_DELETE:"Supprimer",LBL_DOWNLOAD:"Tlcharger",LBL_REFRESH:"Rafraichir",LBL_RELOAD:"Recharger",LBL_HOME:"Accueil",LBL_VIEW:"Aperu",LBL_HELP:"Aide",LBL_ABOUT:" propos",LBL_APPLICATION:"Application",LBL_APPLICATIONS:"Applications",LBL_KILL:"Tuer",LBL_KILL_ALL:"Tuer tout"},Kt={ERR_REQUEST_STANDALONE:"Kan ikke gjre sprringer i standalone modus.",ERR_REQUEST_NOT_OK:"En feil oppstod under sprring: {0}",ERR_VFS_MOUNT_NOT_FOUND:"Filsystem '{0}' ikke funnet",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Filsystem ikke funnet for '{0}'",ERR_VFS_MOUNT_NOT_MOUNTED:"Filsystem '{0}' ikke montert",ERR_VFS_MOUNT_ALREADY_MOUNTED:"Filesystem '{0}' allerede montert",ERR_VFS_PATH_FORMAT_INVALID:"Angitt sti '{0}' tilfredstiller ikke format 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Pakke Metadata '{0}' ikke funnet",ERR_PACKAGE_LOAD:"Pakke Lasting '{0}' feilet: {1}",ERR_PACKAGE_NO_RUNTIME:"Pakke Runtime '{0}' ikke funnet",ERR_PACKAGE_NO_METADATA:"Metadata ikke funnet for '{0}'. Er den i manifestet?",ERR_PACKAGE_EXCEPTION:"En unntaksfeil oppstod i '{0}'",ERR_WINDOW_ID_EXISTS:"Vindu med ID '{0}' eksisterer allerede",ERR_INVALID_LOCALE:"Ugyldig lokalisering '{0}'",LBL_CONNECTION_LOST:"Tilkobling tapt",LBL_CONNECTION_LOST_MESSAGE:"Tilkobling til OS.js var tapt. Kobler til p nytt....",LBL_CONNECTION_RESTORED:"Tilkobling gjenopprettet",LBL_CONNECTION_RESTORED_MESSAGE:"Tilkobling til OS.js var gjenopprettet.",LBL_APP_CAT_DEVELOPMENT:"Utvikling",LBL_APP_CAT_SCIENCE:"Vitenskap",LBL_APP_CAT_GAMES:"Spill",LBL_APP_CAT_GRAPHICS:"Grafikk",LBL_APP_CAT_NETWORK:"Nettverk",LBL_APP_CAT_MULTIMEDIA:"Multimedia",LBL_APP_CAT_OFFICE:"Kontor",LBL_APP_CAT_SYSTEM:"System",LBL_APP_CAT_UTILITIES:"Verkty",LBL_APP_CAT_OTHER:"Andre",LBL_LAUNCH_SELECT:"Velg applikasjon",LBL_LAUNCH_SELECT_MESSAGE:"Velg applikasjon for '{0}'",LBL_DESKTOP_SELECT_WALLPAPER:"Velg bakgrunnsbilde",LBL_DESKTOP_SELECT_THEME:"Velg tema",LBL_SEARCH_TOOLTOP:"Sk i filsystemer ({0})",LBL_SEARCH_PLACEHOLDER:"Sker filsystemer...",LBL_SEARCH_WAIT:"Sker...",LBL_SEARCH_RESULT:"Viser {0} resultater",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"Topp",LBL_LEFT:"Venstre",LBL_RIGHT:"Hyre",LBL_BOTTOM:"Bunn",LBL_MENU:"Meny",LBL_ERROR:"Feil",LBL_INFO:"Info",LBL_MESSAGE:"Melding",LBL_WARNINIG:"Advarsel",LBL_SUCCESS:"Velykket",LBL_FAILURE:"Svikt",LBL_WINDOW:"Vindu",LBL_WINDOWS:"Vinduer",LBL_NOTIFICATION:"Notifikasjon",LBL_NOTIFICATIONS:"Notifikasjoner",LBL_TRAY:"Tray Oppfring",LBL_NAME:"Navn",LBL_TYPE:"Type",LBL_SIZE:"Strrelse",LBL_FILE:"Fil",LBL_NEW:"Ny",LBL_OPEN:"pne",LBL_SAVE:"Lagre",LBL_SAVEAS:"Lagre Som",LBL_OK:"OK",LBL_ABORT:"Abort",LBL_CANCEL:"Avbryt",LBL_CLOSE:"Lukk",LBL_QUIT:"Slutt",LBL_YES:"Ja",LBL_NO:"Nei",LBL_GO:"G",LBL_MKDIR:"Lag ny mappe",LBL_MKFILE:"Lag ny fil",LBL_COPY:"Kopier",LBL_PASTE:"Lim inn",LBL_CUT:"Kutt",LBL_MOVE:"Flytt",LBL_RENAME:"Navngi",LBL_DELETE:"Slett",LBL_DOWNLOAD:"Last ned",LBL_REFRESH:"Gjenoppfrisk",LBL_RELOAD:"Last p nytt",LBL_HOME:"Hjem",LBL_VIEW:"Visning",LBL_HELP:"Hjelp",LBL_ABOUT:"Om",LBL_APPLICATION:"Applikasjon",LBL_APPLICATIONS:"Applikasjoner",LBL_KILL:"Drep",LBL_KILL_ALL:"Drep alle",LBL_MINIMIZE:"Minimisr",LBL_MAXIMIZE:"Maksimisr",LBL_RESTORE:"Gjenopprett",LBL_RAISE:"Lft",LBL_SHADE:"Rull opp",LBL_UNSHADE:"Rull ned",LBL_ONTOP:"Alltid verst",LBL_RESIZE:"Endre strrelse"},$t={ERR_REQUEST_STANDALONE:"Zahteve v samostojnem nainu niso mogoe.",ERR_REQUEST_NOT_OK:"Pri zahtevi je prilo do napake: {0}",ERR_VFS_MOUNT_NOT_FOUND:"Datoteni sistem '{0}' ni najden",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Datoteni sistem ni najden '{0}'",ERR_VFS_MOUNT_NOT_MOUNTED:"Datoteni sistem '{0}' ni nameen",ERR_VFS_MOUNT_ALREADY_MOUNTED:"Datoteni sistem '{0}' e nameen",ERR_VFS_PATH_FORMAT_INVALID:"Podana pot '{0}' se ne ujema z 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Metapodatki paketa '{0}' niso najdeni",ERR_PACKAGE_LOAD:"Pri nalaganju pageta '{0}' je prilo do napake: {1}",ERR_PACKAGE_NO_RUNTIME:"Koda paketa '{0}' ni najdena",ERR_PACKAGE_NO_METADATA:"Metapodatki '{0}' niso najdeni. Ali so v datoteki manifest?",ERR_PACKAGE_EXCEPTION:"Sproena je bila izjema v '{0}'",ERR_WINDOW_ID_EXISTS:"Okno z ID-jem '{0}' e obstaja",ERR_INVALID_LOCALE:"Neveljaven prevod '{0}'",LBL_CONNECTION_LOST:"Izguba povezave",LBL_CONNECTION_LOST_MESSAGE:"Povezava do strenika je bila izgubljena. Ponovno povezovanje ...",LBL_CONNECTION_RESTORED:"Vzpostavitev povezave",LBL_CONNECTION_RESTORED_MESSAGE:"Povezava do strenika je bila ponovno vzpostavljena.",LBL_APP_CAT_DEVELOPMENT:"Razvoj",LBL_APP_CAT_SCIENCE:"Znanost",LBL_APP_CAT_GAMES:"Igre",LBL_APP_CAT_GRAPHICS:"Grafika",LBL_APP_CAT_NETWORK:"Omreje",LBL_APP_CAT_MULTIMEDIA:"Multimedija",LBL_APP_CAT_OFFICE:"Pisarna",LBL_APP_CAT_SYSTEM:"Sistem",LBL_APP_CAT_UTILITIES:"Orodja",LBL_APP_CAT_OTHER:"Drugo",LBL_LAUNCH_SELECT:"Izberite aplikacijo",LBL_LAUNCH_SELECT_MESSAGE:"Izberite aplikacijo za '{0}'",LBL_DESKTOP_SELECT_WALLPAPER:"Izberite ozadje",LBL_DESKTOP_SELECT_THEME:"Izberite temo",LBL_SEARCH_TOOLTOP:"Ii datoteni sistem ({0})",LBL_SEARCH_PLACEHOLDER:"Iskanje po datotenih sistemih ...",LBL_SEARCH_WAIT:"Iskanje ...",LBL_SEARCH_RESULT:"Prikaz {0} rezultatov",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"Zgoraj",LBL_LEFT:"Levo",LBL_RIGHT:"Desno",LBL_BOTTOM:"Spodaj",LBL_MENU:"Meni",LBL_ERROR:"Napaka",LBL_INFO:"Informacije",LBL_MESSAGE:"Sporoilo",LBL_WARNINIG:"Opozorilo",LBL_SUCCESS:"Uspeh",LBL_FAILURE:"Neuspeh",LBL_WINDOW:"Okno",LBL_WINDOWS:"Okna",LBL_NOTIFICATION:"Obvestilo",LBL_NOTIFICATIONS:"Obvestila",LBL_TRAY:"Element vrstice",LBL_NAME:"Ime",LBL_TYPE:"Vrsta",LBL_SIZE:"Velikost",LBL_FILE:"Datoteka",LBL_NEW:"Novo",LBL_OPEN:"Odpri",LBL_SAVE:"Shrani",LBL_SAVEAS:"Shrani kot",LBL_OK:"V redu",LBL_ABORT:"Prekini",LBL_CANCEL:"Preklii",LBL_CLOSE:"Zapri",LBL_QUIT:"Izklopi",LBL_YES:"Da",LBL_NO:"Ne",LBL_GO:"Pojdi",LBL_MKDIR:"Ustvari novo mapo",LBL_MKFILE:"Ustvari novo datoteko",LBL_COPY:"Kopiraj",LBL_PASTE:"Prilepi",LBL_CUT:"Izrei",LBL_MOVE:"Premakni",LBL_RENAME:"Preimenuj",LBL_DELETE:"Izbrii",LBL_DOWNLOAD:"Prenesi",LBL_REFRESH:"Osvei",LBL_RELOAD:"Osvei",LBL_HOME:"Domov",LBL_VIEW:"Pogled",LBL_HELP:"Pomo",LBL_ABOUT:"O programu",LBL_APPLICATION:"Aplikacija",LBL_APPLICATIONS:"Aplikacije",LBL_KILL:"Konaj",LBL_KILL_ALL:"Konaj vse"},Wt={ERR_REQUEST_STANDALONE:"Khng th gi yu cu  ch  c lp.",ERR_REQUEST_NOT_OK:" xy ra li khi thc hin yu cu: {0}",ERR_VFS_MOUNT_NOT_FOUND:"Khng tm thy h thng tp tin '{0}'",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Khng tm thy h thng tp tin cho '{0}'",ERR_VFS_MOUNT_NOT_MOUNTED:"H thng tp tin '{0}' khng c gn kt",ERR_VFS_MOUNT_ALREADY_MOUNTED:"H thng tp tin '{0}'  c gn kt",ERR_VFS_PATH_FORMAT_INVALID:"nh dng ng dn '{0}' khng khp vi 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Khng tm thy siu d liu ca gi '{0}'",ERR_PACKAGE_LOAD:"Ti gi '{0}' tht bi: {1}",ERR_PACKAGE_NO_RUNTIME:"Khng tm thy Runtime ca gi '{0}'",ERR_PACKAGE_NO_METADATA:"Khng tm thy siu d liu cho '{0}'. Bn c chc n  c bo co trong manifest khng?",ERR_PACKAGE_EXCEPTION:" xy ra li trong '{0}'",ERR_WINDOW_ID_EXISTS:"Ca s vi ID '{0}'  tn ti",ERR_INVALID_LOCALE:"Ngn ng khng hp l '{0}'",LBL_CONNECTION_LOST:"Mt kt ni",LBL_CONNECTION_LOST_MESSAGE:"Kt ni vi OS.js  b mt. ang kt ni li....",LBL_CONNECTION_RESTORED:" khi phc kt ni",LBL_CONNECTION_RESTORED_MESSAGE:"Kt ni vi my ch OS.js  c khi phc.",LBL_APP_CAT_DEVELOPMENT:"Pht trin",LBL_APP_CAT_SCIENCE:"Khoa hc",LBL_APP_CAT_GAMES:"Tr chi",LBL_APP_CAT_GRAPHICS:" ha",LBL_APP_CAT_NETWORK:"Mng",LBL_APP_CAT_MULTIMEDIA:"a phng tin",LBL_APP_CAT_OFFICE:"Vn phng",LBL_APP_CAT_SYSTEM:"H thng",LBL_APP_CAT_UTILITIES:"Tin ch",LBL_APP_CAT_OTHER:"ng dng khc",LBL_LAUNCH_SELECT:"Chn ng dng",LBL_LAUNCH_SELECT_MESSAGE:"Chn ng dng cho '{0}'",LBL_DESKTOP_SELECT_WALLPAPER:"Chn hnh nn",LBL_DESKTOP_SELECT_THEME:"Chn ch ",LBL_SEARCH_TOOLTOP:"Tm kim d liu ({0})",LBL_SEARCH_PLACEHOLDER:"Tm kim cc d liu...",LBL_SEARCH_WAIT:"ang tm kim...",LBL_SEARCH_RESULT:"ang hin th {0} kt qu",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"Trn cng",LBL_LEFT:"Tri",LBL_RIGHT:"Phi",LBL_BOTTOM:"Di cng",LBL_MENU:"Menu",LBL_ERROR:"Li",LBL_INFO:"Thng tin",LBL_MESSAGE:"Thng bo",LBL_WARNINIG:"Cnh bo",LBL_SUCCESS:"Thnh cng",LBL_FAILURE:"Tht bi",LBL_WINDOW:"Ca s",LBL_WINDOWS:"Cc ca s",LBL_NOTIFICATION:"Thng bo",LBL_NOTIFICATIONS:"Cc thng bo",LBL_TRAY:"Mc khay h thng",LBL_NAME:"Tn",LBL_TYPE:"Kiu",LBL_SIZE:"Kch thc",LBL_FILE:"Tp tin",LBL_NEW:"Mi",LBL_OPEN:"M",LBL_SAVE:"Lu",LBL_SAVEAS:"Lu nh",LBL_OK:"OK",LBL_ABORT:"Hy thao tc",LBL_CANCEL:"Hy b",LBL_CLOSE:"ng",LBL_QUIT:"Thot",LBL_YES:"C",LBL_NO:"Khng",LBL_GO:"i",LBL_MKDIR:"To th mc mi",LBL_MKFILE:"To tp mi",LBL_COPY:"Sao chp",LBL_PASTE:"Dn",LBL_CUT:"Ct",LBL_MOVE:"Di chuyn",LBL_RENAME:"i tn",LBL_DELETE:"Xa",LBL_DOWNLOAD:"Ti v",LBL_REFRESH:"Lm mi",LBL_RELOAD:"Ti li",LBL_HOME:"Trang ch",LBL_VIEW:"Xem",LBL_HELP:"Hng dn",LBL_ABOUT:"Thng tin",LBL_APPLICATION:"ng dng",LBL_APPLICATIONS:"Cc ng dng",LBL_KILL:"ng",LBL_KILL_ALL:"ng tt c"},zt={ERR_REQUEST_STANDALONE:"Cannot make requests in standalone mode.",ERR_REQUEST_NOT_OK:"An error occured while performing a request: {0}",ERR_VFS_MOUNT_NOT_FOUND:"Filesystem '{0}' nicht gefunden",ERR_VFS_MOUNT_NOT_FOUND_FOR:"Filesystem fr '{0}' nicht gefunden",ERR_VFS_MOUNT_NOT_MOUNTED:"Filesystem '{0}' nicht gemountet",ERR_VFS_MOUNT_ALREADY_MOUNTED:"Filesystem '{0}' schon gemountet",ERR_VFS_PATH_FORMAT_INVALID:"Given path '{0}' does not match 'name:/path'",ERR_PACKAGE_NOT_FOUND:"Paket-Metadaten  '{0}' nicht gefunden",ERR_PACKAGE_LOAD:"Paket Laden '{0}' ist fehlgeschlagen: {1}",ERR_PACKAGE_NO_RUNTIME:"Paketlaufzeit '{0}' nicht gefunden",ERR_PACKAGE_NO_METADATA:"Metadaten fr '{0}' nicht gefunden. Ist es in der Manifest?",ERR_PACKAGE_EXCEPTION:"Eine Ausnahme trat in '{0}' auf.",ERR_WINDOW_ID_EXISTS:"Fenster mit der ID '{0}' existiert schon",ERR_INVALID_LOCALE:"Invalid locale '{0}'",LBL_CONNECTION_LOST:"Verbindung unterbrochen",LBL_CONNECTION_LOST_MESSAGE:"Die Verbindung zu OS.js wurde unterbrochen. Wiederverbinden... ",LBL_CONNECTION_RESTORED:"Verbindung wiederhergestellt",LBL_CONNECTION_RESTORED_MESSAGE:"Die Verbindung OS.js server was restored.",LBL_APP_CAT_DEVELOPMENT:"IT-Entwicklung",LBL_APP_CAT_SCIENCE:"Wissenschaft",LBL_APP_CAT_GAMES:"Spiels",LBL_APP_CAT_GRAPHICS:"Grafiken",LBL_APP_CAT_NETWORK:"Netzwerk",LBL_APP_CAT_MULTIMEDIA:"Multimedia",LBL_APP_CAT_OFFICE:"Office",LBL_APP_CAT_SYSTEM:"System",LBL_APP_CAT_UTILITIES:"Dienstprogramme",LBL_APP_CAT_OTHER:"Andere",LBL_LAUNCH_SELECT:"Applikation auswhlen",LBL_LAUNCH_SELECT_MESSAGE:"Applikation fr '{0}' auswhlen",LBL_DESKTOP_SELECT_WALLPAPER:"Wallpaper auswhlen",LBL_DESKTOP_SELECT_THEME:"Theme auswhlen",LBL_SEARCH_TOOLTOP:"Dateisysteme ({0}) finden",LBL_SEARCH_PLACEHOLDER:"Dateisysteme finden...",LBL_SEARCH_WAIT:"Suche...",LBL_SEARCH_RESULT:"Anzeige von {0} Ergebnissen",LBL_FS_B:"B",LBL_FS_M:"M",LBL_FS_G:"G",LBL_FS_KIB:"KiB",LBL_FS_MIB:"MiB",LBL_FS_GIB:"GiB",LBL_TOP:"Oben",LBL_LEFT:"Links",LBL_RIGHT:"Rechts",LBL_BOTTOM:"Unten",LBL_MENU:"Men",LBL_ERROR:"Error",LBL_INFO:"Info",LBL_MESSAGE:"Message",LBL_WARNINIG:"Warnung",LBL_SUCCESS:"Success",LBL_FAILURE:"Failure",LBL_WINDOW:"Fenster",LBL_WINDOWS:"Fenster",LBL_NOTIFICATION:"Benachrichtigung",LBL_NOTIFICATIONS:"Benachrichtigungen",LBL_TRAY:"Infobereich-Eintrag",LBL_NAME:"Name",LBL_TYPE:"Typ",LBL_SIZE:"Gre",LBL_FILE:"Datei",LBL_NEW:"Neue",LBL_OPEN:"ffnen",LBL_SAVE:"Speichern",LBL_SAVEAS:"Speichern als",LBL_OK:"OK",LBL_ABORT:"Abbrechen",LBL_CANCEL:"Beenden",LBL_CLOSE:"Schlieen",LBL_QUIT:"Verlassen",LBL_YES:"Ja",LBL_NO:"Nein",LBL_GO:"Los",LBL_MKDIR:"Neues Verzeichnis erstellen",LBL_MKFILE:"Neue Datei erstellen",LBL_COPY:"Kopieren",LBL_PASTE:"Einfgen",LBL_CUT:"Ausschneiden",LBL_MOVE:"Verschieben",LBL_RENAME:"Umbenennen",LBL_DELETE:"Lschen",LBL_DOWNLOAD:"Herunterladen",LBL_REFRESH:"Aktualisieren",LBL_RELOAD:"Neu laden",LBL_HOME:"Startseite",LBL_VIEW:"Ansicht",LBL_HELP:"Hilfe",LBL_ABOUT:"ber",LBL_APPLICATION:"Anwendungsprogramme",LBL_APPLICATIONS:"Anwendungsprogrammen",LBL_KILL:"Beenden",LBL_KILL_ALL:"Beenden alle"},Vt=function(t){return t.split("/").reverse()[0]},Yt=function(t){function e(t,n,r,o){var i;return d()(this,e),(i=v()(this,g()(e).call(this,"BasicApplication<"+n.name+">"))).core=t,i.proc=n,i.win=r,i.options=Object.assign({mimeTypes:n.metadata.mimes||[],defaultFilename:"New File"},o),i}return b()(e,t),p()(e,[{key:"destroy",value:function(){this.off()}},{key:"init",value:function(){return this.proc.args.file?this.open(this.proc.args.file):this.create(),Promise.resolve(!0)}},{key:"getDialogOptions",value:function(t){var e=this.options.defaultFilename,n=this.core.config("vfs.defaultPath"),r=this.proc.args.file?this.proc.args.file.path:null;return[{type:t,mime:this.options.mimeTypes,filename:r?Vt(r):e,path:r?function(t){var e=t.split("/");return e.splice(e.length-1,1),e.join("/")}(r):n},{parent:this.win,attributes:{modal:!0}}]}},{key:"updateWindowTitle",value:function(){if(this.win){var t=(0,this.core.make("osjs/locale").translatableFlat)(this.proc.metadata.title),e=this.proc.args.file?Vt(this.proc.args.file.path):this.options.defaultFilename;e?this.win.setTitle("".concat(t," - ").concat(e)):this.win.setTitle(t)}}},{key:"createDialog",value:function(t,e){var n=this.getDialogOptions(t),r=H()(n,2),o=r[0],i=r[1];this.core.make("osjs/dialog","file",o,i,function(t,n){"ok"===t&&e(n)})}},{key:"open",value:function(t){this.proc.args.file=Object.assign({},t),this.emit("open-file",t),this.updateWindowTitle()}},{key:"save",value:function(t){this.proc.args.file=Object.assign({},t),this.emit("save-file",t),this.updateWindowTitle()}},{key:"create",value:function(){this.proc.args.file=null,this.emit("new-file"),this.updateWindowTitle()}},{key:"createNew",value:function(){this.create()}},{key:"createSaveDialog",value:function(){var t=this;this.createDialog("save",function(e){return t.save(e)})}},{key:"createOpenDialog",value:function(){var t=this;this.createDialog("load",function(e){return t.open(e)})}}]),e}(w.EventEmitter),qt=function(t){var e=t.config("providers.globalBlacklist",[]),n=t.config("providers.globalWhitelist",[]);return Object.freeze({make:function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var s=o[0];if(t.has(s)){var a=e.length>0&&-1!==e.indexOf(s),u=n.length>0&&-1===n.indexOf(s);if(a||u)throw new Error("The provider '".concat(s,"' cannot be used via global scope"))}return t.make.apply(t,o)},register:function(){var e;return(e=t.make("osjs/packages")).register.apply(e,arguments)},url:function(){return t.url.apply(t,arguments)},run:function(){return t.run.apply(t,arguments)},open:function(){return t.open.apply(t,arguments)},request:function(){return t.request.apply(t,arguments)}})},Zt=function(t){var e=function(){var t=function(t,e){return Object.keys(t).reduce(function(n,r){return Object.assign(u()({},r,"probably"===e.canPlayType(t[r])),n)},{})};return{audio:t({mp3:"audio/mpeg",mp4:"audio/mp4",oga:"audio/ogg"},document.createElement("audio")),video:t({mp4:"video/mp4",ogv:"video/ogg"},document.createElement("video"))}}(),n=function(){var e=t.config("desktop.settings.sounds");return t.make("osjs/settings").get("osjs/desktop","sounds",e)};return{themeResource:function(e){var n=t.config("desktop.settings.theme"),r=t.make("osjs/settings").get("osjs/desktop","theme",n);return t.url("themes/".concat(r,"/").concat(e))},soundResource:function(r){r.match(/\.([a-z]+)$/)||(r+="."+(["oga","mp3"].find(function(t){return!0===e.audio[t]})||"mp3"));var o=n();return o?t.url("sounds/".concat(o,"/").concat(r)):null},soundsEnabled:function(){return!!n()},icon:function(e){var n=t.config("desktop.settings.icons"),r=t.make("osjs/settings").get("osjs/desktop","icons",n);return t.url("icons/".concat(r,"/icons/").concat(e))}}},Xt=function(t){function e(t){var n;arguments.length>1&&void 0!==arguments[1]&&arguments[1];return d()(this,e),n=v()(this,g()(e).call(this,t)),window.OSjs=qt(t),n.session=new Mt(t),n.tray=new Ft(t),n.pm=new Dt(t),n.clipboard=new Ut,n}return b()(e,t),p()(e,[{key:"provides",value:function(){return["osjs/application","osjs/basic-application","osjs/window","osjs/windows","osjs/event-handler","osjs/window-behaviour","osjs/dnd","osjs/dom","osjs/clipboard","osjs/tray","osjs/locale","osjs/packages","osjs/websocket","osjs/session","osjs/theme","osjs/sounds"]}},{key:"destroy",value:function(){this.tray.destroy(),this.pm.destroy(),this.clipboard.destroy(),_()(g()(e.prototype),"destroy",this).call(this)}},{key:"init",value:function(){var t=this,e=Zt(this.core),n=e.themeResource,i=e.soundResource,s=e.soundsEnabled,a=e.icon,u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new U(t.core,e)};this.core.instance("osjs/websocket",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xt()(T,e)}),this.core.instance("osjs/application",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new X(t.core,e)}),this.core.instance("osjs/basic-application",function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Yt(t.core,e,n,r)}),this.core.instance("osjs/window",u),this.core.singleton("osjs/windows",function(){return{create:u,list:function(){return U.getWindows()},last:function(){return U.lastWindow()}}}),this.core.instance("osjs/event-handler",function(){console.warn("osjs/event-handler is deprecated, use osjs/event-emitter");for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xt()(w.EventEmitter,e)}),this.core.instance("osjs/event-emitter",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return xt()(w.EventEmitter,e)}),this.core.singleton("osjs/window-behavior",function(){return"function"==typeof t.options.windowBehavior?t.options.windowBehavior(t.core):new Pt(t.core)}),this.core.singleton("osjs/session",function(){return{save:function(){return t.session.save()},load:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t.session.load(e)}}}),this.core.singleton("osjs/dnd",function(){return r}),this.core.singleton("osjs/dom",function(){return{script:j,style:k}});var c={create:function(e,n){return t.tray.create(e,n)},list:function(){return t.tray.entries.map(function(t){return Object.assign({},t)})}};this.core.instance("osjs/tray",function(t){return void 0!==t?c.create(t):c});var l={format:function(t){return function(e,n){var r=rt(t,"format."+n),o=r.defaultLocale,i=r.userLocale||o||n;return tt()(e,i)}}(this.core),translate:ot(this.core)(o),translatable:ot(this.core),translatableFlat:function(t){return function(e,n){var r=rt(t,"language"),o=r.defaultLocale;return e[r.userLocale]||e[o]||e.en_EN||n}}(this.core),setLocale:function(e){return e in o?t.core.make("osjs/settings").set("osjs/locale","language",e).save().then(function(){return t.core.emit("osjs/locale:change",e)}):Promise.reject(l.translate("ERR_INVALID_LOCALE",e))}};return this.core.singleton("osjs/locale",function(){return l}),this.core.singleton("osjs/packages",function(){return{getCompatiblePackages:function(){var e;return(e=t.pm).getCompatiblePackages.apply(e,arguments)},getPackages:function(){var e;return(e=t.pm).getPackages.apply(e,arguments)},register:function(){var e;return(e=t.pm).register.apply(e,arguments)},launch:function(){var e;return(e=t.pm).launch.apply(e,arguments)},preload:function(){var e;return(e=t.pm).preload.apply(e,arguments)},running:function(){return t.pm.running}}}),this.core.instance("osjs/clipboard",function(){return{set:function(e){return t.clipboard.set(e)},get:function(e){return t.clipboard.get(e)},clear:function(){return t.clipboard.clear()}}}),this.core.on("osjs/core:started",function(){t.session.load()}),this.core.singleton("osjs/theme",function(){return{resource:n,icon:function(t){return a(t.replace(/(\.png)?$/,".png"))}}}),this.core.singleton("osjs/sounds",function(){return{resource:i,play:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s()){var n=t.match(/^(\/|https?:)/)?t:i(t);if(n)return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({volume:1},e),r=new Audio;r.voule=n.volume,r.src=t;try{var o=r.play();if(o instanceof Promise)return o.then(function(){return r}).catch(function(e){return console.warn("Failed to play sound",t,e)})}catch(e){console.warn("Failed to play sound",t,e)}return Promise.resolve(r)}(n,e)}return!1}}}),this.pm.init()}},{key:"start",value:function(){var t=this;this.core.config("development")&&(this.core.on("osjs/dist:changed",function(e){var n=t.core.url(e).replace(/^\//,""),r=t.core.$resourceRoot.querySelectorAll("link[rel=stylesheet]"),o=Array.from(r).reduce(function(t,e){var n=e.getAttribute("href").split("?")[0].replace(/^\//,"");return Object.assign(u()({},n,e),t)},{});o[n]&&(console.info("Hot-reloading",n),setTimeout(function(){o[n].setAttribute("href",n)},100))}),this.core.on("osjs/packages:metadata:changed",function(){t.pm.init()}),this.core.on("osjs/packages:package:changed",function(t){X.getApplications().filter(function(e){return e.metadata.name===t}).forEach(function(t){return t.relaunch()})}))}}]),e}(Q.ServiceProvider),Qt=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(this,e),(n=v()(this,g()(e).call(this,t,r||{}))).desktop=null,n}return b()(e,t),p()(e,[{key:"destroy",value:function(){this.desktop=this.desktop.destroy()}},{key:"provides",value:function(){return["osjs/desktop"]}},{key:"init",value:function(){var t=this;this.desktop=new bt(this.core,this.options),this.desktop.init(),this.core.singleton("osjs/desktop",function(){return{addContextMenuEntries:function(e){return t.desktop.addContextMenu(e)},applySettings:function(e){return t.desktop.applySettings(e)},getRect:function(){return t.desktop.getRect()}}}),this.core.on("osjs/core:started",function(){t.desktop.applySettings()})}},{key:"start",value:function(){this.desktop.start()}}]),e}(Q.ServiceProvider),Jt=function(t){function e(t){var n;return d()(this,e),(n=v()(this,g()(e).call(this,t))).$element=null,n}return b()(e,t),p()(e,[{key:"destroy",value:function(){this.$element.remove(),this.$element=null}},{key:"provides",value:function(){return["osjs/notification"]}},{key:"init",value:function(){var t=this;this.$element=document.createElement("div"),this.core.instance("osjs/notification",function(e){if(!e)throw new Error("Notification options not given");var n=new At(t.core,t.$element,e);return n.render(),n})}},{key:"start",value:function(){this.$element.classList.add("osjs-notifications"),this.core.$root.appendChild(this.$element)}}]),e}(Q.ServiceProvider),te=function(t){return t.replace(/\/$/,"").split("/").filter(function(t,e,n){return e<n.length-1}).join("/").replace(/\/?$/,"/")},ee=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(function(t,e,n){return t.concat([n>0?e.replace(/\/$/,""):e])},[]).join("/")},ne=function(t){return function(e,n){return function(r,o){return"string"===t?"asc"===n?String(r[e]).localeCompare(o[e]):String(o[e]).localeCompare(r[e]):"date"===t?"asc"===n?new Date(r[e])>new Date(o[e]):new Date(o[e])>new Date(r[e]):r[e]<o[e]?-1:r[e]>o[e]?"asc"===n?1:0:"asc"===n?0:1}}},re={size:ne("number"),mtime:ne("date"),ctime:ne("date"),atime:ne("date")},oe=function(t,e,n){return new Promise(function(r,o){var i=new Blob([e],{type:n}),s=new FileReader;s.onerror=function(t){return o(t)},s.onloadend=function(){return r(s.result)},s[t](i)})},ie=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(isNaN(t)||"number"!=typeof t)&&(t=0);var n=e?1e3:1024,r=e?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];if(t<n)return t+" B";var o=-1;do{t/=n,++o}while(t>=n);return"".concat(t.toFixed(1)," ").concat(r[o])},se=function(t,e){var n=t.path,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r=Object.assign({},{showHiddenFiles:!1,sortBy:"filename",sortDir:"asc"},r),i=o.sortDir,s=o.sortBy,a=o.filter;"function"!=typeof a&&(a=function(){return!0}),-1===["asc","desc"].indexOf(i)&&(i="asc");var u=r.showHiddenFiles?function(){return!0}:function(t){return"."!==t.filename.substr(0,1)},c=re[s]?re[s]():ne("string"),f=function(t){return Object.assign(t,{humanSize:ie(t.size)})},d=function(t){var e=[];return"/"!==(t.replace(/\/+/g,"/").replace(/^(\w+):/,"")||"/")&&e.push({isDirectory:!0,isFile:!1,mime:null,size:0,stat:{},filename:"..",path:te(t)||"/"}),e}(n).sort(c(s,i)).map(f),h=e.filter(function(t){return t.isDirectory}).sort(c(s,i)).filter(u).filter(a).map(f),p=e.filter(function(t){return!t.isDirectory}).sort(c(s,i)).filter(u).filter(a).map(f);return l()(d).concat(l()(h),l()(p))},ae=function(t,e,n){return"string"===n?oe("readAsText",t,e):"uri"===n?oe("readAsDataURL",t,e):"blob"===n?Promise.resolve(new Blob([t],{type:e})):Promise.resolve(t)},ue=function(t){return function(e){return e.isDirectory?{name:"folder"}:function(e){var n=Object.keys(t).find(function(t){return new RegExp(t).test(e.mime)});return n?t[n]:{name:"application-x-executable"}}(e)}},ce=function(t){return Object.assign({isDirectory:!1,isFile:!0,mime:"application/octet-stream",icon:null,size:-1,path:null,filename:null,label:null,stat:{},id:null,parent_id:null},t)},le=function(t){return Object.assign({id:null},"string"==typeof t?{path:t}:t)},fe=function(t,e){return function(n){return Promise.resolve(n.map(function(t){return ce(t)})).then(function(n){return se(le(t),n,{showHiddenFiles:!1!==e.showHiddenFiles,filter:e.filter})})}},de=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.readdir(le(n),r,e).then(fe(n,r))}},he=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.readfile(le(n),r,o,e).then(function(t){return ae(t.body,t.mime,r)})}},pe=function(t,e){return function(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r instanceof ArrayBuffer||r instanceof Blob?r:new Blob([r],{type:"application/octet-stream"});return t.writefile(le(n),i,o,e)}},me=function(t,e){return function(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.copy(le(n),le(r),o,e)}},ve=function(t,e){return function(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.rename(le(n),le(r),o,e)}},Le=ve,ge=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.mkdir(le(n),r,e)}},ye=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.unlink(le(n),r,e)}},_e=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.exists(le(n),r,e)}},Ee=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.stat(le(n),r,e).then(function(t){return ce(t)})}},be=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.url(le(n),r,e)}},Oe=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"function"==typeof t.download&&!0!==r.readfile?t.download(le(n),r,e):he(t)(n,"blob").then(function(t){var e=le(n).path.split("/").splice(-1)[0],r=window.URL.createObjectURL(t),o=document.createElement("a");o.style.display="none",o.href=r,o.download=e,document.body.appendChild(o),o.click(),setTimeout(function(){window.URL.revokeObjectURL(r),o.remove()},1)})}},Ae=function(t,e){return function(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.attributes&&!1===e.attributes.searchable?Promise.resolve([]):t.search(le(n),r,o,e).then(fe(n,o))}},we=function(t,e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.touch(le(n),r,e)}},Te=function(t){var e=["exists","stat","readdir","readfile"],n=function(n,r,o){return t.request(t.url("/vfs/".concat(n)),{body:r,method:-1!==e.indexOf(n)?"get":"post"},o).then(function(t){if("json"===o)return{mime:"application/json",body:t};var e=t.headers.get("content-type")||"application/octet-stream";return t.arrayBuffer().then(function(t){return{mime:e,body:t}})})};return{readdir:function(t,e){var r=t.path;return n("readdir",{path:r,options:{}},"json").then(function(t){return t.body})},readfile:function(t,e,r){var o=t.path;return n("readfile",{path:o,options:r})},writefile:function(t,e,r){var o=t.path,i=new FormData;return i.append("upload",e),i.append("path",o),i.append("options",r),n("writefile",i).then(function(t){return t.body})},copy:function(t,e,r){return n("copy",{from:t.path,to:e.path,options:r},"json").then(function(t){return t.body})},rename:function(t,e,r){return n("rename",{from:t.path,to:e.path,options:r},"json").then(function(t){return t.body})},mkdir:function(t,e){var r=t.path;return n("mkdir",{path:r,options:e},"json").then(function(t){return t.body})},unlink:function(t,e){var r=t.path;return n("unlink",{path:r,options:e},"json").then(function(t){return t.body})},exists:function(t,e){var r=t.path;return n("exists",{path:r,options:e},"json").then(function(t){return t.body})},stat:function(t,e){var r=t.path;return n("stat",{path:r,options:e},"json").then(function(t){return t.body})},url:function(e,n){var r=e.path;return Promise.resolve(t.url("/vfs/readfile?path=".concat(encodeURIComponent(r))))},search:function(t,e,r){var o=t.path;return n("search",{root:o,pattern:e,options:r},"json").then(function(t){return t.body})},touch:function(t,e){var r=t.path;return n("touch",{path:r,options:e},"json").then(function(t){return t.body})},download:function(t){var e=t.path,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=encodeURIComponent(JSON.stringify({download:!0}));return Promise.resolve("/vfs/readfile?options=".concat(r,"&path=")+encodeURIComponent(e)).then(function(t){return(n.target||window).open(t)})}}},Se=function(t){var e=t.make("osjs/packages");return{readdir:function(n,r){var o=n.path;return Promise.resolve(e.getPackages()).then(function(e){return e.map(function(e){return{isDirectory:!1,isFile:!0,filename:e.name,mime:"osjs/application",path:"".concat(o,"/").concat(e.name),size:0,stat:{},icon:e.icon?t.url(e.icon,e):null}})})}}},Be={readdir:function(t,e){return Promise.resolve([])},readfile:function(t,e,n){return Promise.resolve({body:null,mime:"application/octet-stream"})},writefile:function(t,e,n){return Promise.resolve(-1)},copy:function(t,e,n){return Promise.resolve(!1)},rename:function(t,e,n){return Promise.resolve(!1)},mkdir:function(t,e){return Promise.resolve(!1)},unlink:function(t,e){return Promise.resolve(!1)},exists:function(t,e){return Promise.resolve(!1)},stat:function(t,e){return Promise.resolve({})},url:function(t,e){return Promise.resolve(null)},mount:function(t){return Promise.resolve(!0)},unmount:function(t){return Promise.resolve(!0)},search:function(t,e,n){return Promise.resolve([])},touch:function(t,e){return Promise.resolve([])}},ke=function(t,e,n){var r="string"==typeof n?n:n.path,o=String(r).replace(/\+/g,"/").match(/^(\w+):(.*)/),i=Array.from(o||[]).slice(1),s=H()(i,1)[0],a=t.make("osjs/locale").translate;if(!s)throw new Error(a("ERR_VFS_PATH_FORMAT_INVALID",r));var u=e.find(function(t){return t.name===s});if(!u)throw new Error(a("ERR_VFS_MOUNT_NOT_FOUND_FOR","".concat(s,":")));return u},je=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(this,e),r=Object.assign({},{adapters:{},mounts:[]},r),(n=v()(this,g()(e).call(this,"Filesystem"))).core=t,n.adapters=Object.assign({},{system:Te,apps:Se},n.core.config("vfs.adapters",{}),r.adapters),n.mounts=[],n.options={},n.proxy=Object.keys(s).reduce(function(t,e){return Object.assign(u()({},e,function(){for(var t,r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(t=n)._request.apply(t,[e].concat(o))}),t)},{}),n}return b()(e,t),p()(e,[{key:"mountAll",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.mounts=this.core.config("vfs.mountpoints").concat(this.options.mounts||[]).map(function(e){try{return function(t,e,n){var r=n.adapter||t.config("vfs.defaultAdapter"),o=Object.assign({},Be,e[r](t)),i=Et({enabled:!0,mounted:!1,adapter:r,attributes:{visibility:"global",local:!0,searchable:!0,readOnly:!1}},n);return Object.assign({_adapter:o,label:r,root:"".concat(i.name||r,":/")},i)}(t.core,t.adapters,e)}catch(t){console.warn(t)}return null}).filter(function(t,e,n){return n.findIndex(function(e){return e.label===t.label||e.root===t.label})===e||(console.warn("Removed duplicate mountpoint",t),!1)}).filter(function(t){return null!==t});return Promise.all(this.mounts.map(function(n){return e?t._mount(n):t._mount(n).catch(function(t){return console.warn(t)})}))}},{key:"_mount",value:function(t){var e=this;return t._adapter.mount({},t).then(function(n){return n&&(t.mounted=!0,e.emit("mounted",t),e.core.emit("osjs/fs:mount")),n})}},{key:"_unmount",value:function(t){var e=this;return t._adapter.unmount({},t).then(function(n){return n&&(t.mounted=!1,e.emit("unmounted",t),e.core.emit("osjs/fs:unmount")),n})}},{key:"mount",value:function(t){var e=this;return Promise.resolve(this.mounts.find(function(e){return e.name===t})).then(function(n){var r=e.core.make("osjs/locale").translate;if(!n)throw new Error(r("ERR_VFS_MOUNT_NOT_FOUND",t));if(!n.mounted)throw new Error(r("ERR_VFS_MOUNT_ALREADY_MOUNTED",t));return e._mount(n)})}},{key:"unmount",value:function(t){var e=this;return Promise.resolve(this.mounts.find(function(e){return e.name===t})).then(function(n){var r=e.core.make("osjs/locale").translate;if(!n)throw new Error(r("ERR_VFS_MOUNT_NOT_FOUND",t));if(!n.mounted)throw new Error(r("ERR_VFS_MOUNT_NOT_MOUNTED",t));return e._unmount(n)})}},{key:"request",value:function(){return this.proxy}},{key:"_request",value:function(t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(-1!==["rename","move","copy"].indexOf(t)){var i=r[0],a=r[1],u=ke(this.core,this.mounts,i),c=ke(this.core,this.mounts,a);if(!(u.adapter===c.adapter))return he(u._adapter,u)(i).then(function(t){return pe(c._adapter,c)(a,t)}).then(function(e){return"rename"===t?ye(u._adapter,u)(i).then(function(){return e}):e})}var l=r[0],f=ke(this.core,this.mounts,l);return(e=this.core).emit.apply(e,["osjs/vfs:".concat(t)].concat(r)),s[t](f._adapter,f).apply(void 0,r)}},{key:"getMounts",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.core.make("osjs/theme");return this.mounts.filter(function(e){return t||e.mounted}).filter(function(t){return!1!==t.enabled}).map(function(t){return{attributes:Object.assign({},t.attributes),icon:function(t){return t?"string"==typeof t?t:e.icon(t.name):e.icon("drive-harddisk")}(t.icon),name:t.name,label:t.label,root:t.root}})}}]),e}(w.EventEmitter),Ne=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(this,e),(n=v()(this,g()(e).call(this,t))).fs=new je(t,{adapters:r.adapters||{},mounts:r.mounts||[]}),n}return b()(e,t),p()(e,[{key:"provides",value:function(){return["osjs/vfs","osjs/fs"]}},{key:"init",value:function(){var t=this;this.core.singleton("osjs/vfs",function(){return t.fs.request()});var e=this.core.config("vfs.icons",{}),n=ue(e);return this.core.singleton("osjs/fs",function(){return{pathJoin:function(){return ee.apply(i,arguments)},icon:n,mountpoints:function(){var e;return(e=t.fs).getMounts.apply(e,arguments)},mount:function(){var e;return(e=t.fs).mount.apply(e,arguments)},unmount:function(){var e;return(e=t.fs).unmount.apply(e,arguments)},register:function(){var e;return(e=t.fs).register.apply(e,arguments)}}}),this.fs.mountAll(!1)}}]),e}(Q.ServiceProvider),Pe=n(12),Re=n.n(Pe),Ce=n(16),Ie=n.n(Ce),xe=function(t,e){return{login:function(t){return Promise.resolve(t)}}},Me={server:function(t,e){var n=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.request(e,{method:"POST",body:JSON.stringify(n)},"json")};return{login:function(e){return n(t.url("/login"),e)},logout:function(){return n(t.url("/logout"))}}},localStorage:xe},De=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d()(this,e),n=v()(this,g()(e).call(this,t));var o=t.config("auth.ui",{}),i=t.config("standalone")?xe:"function"==typeof r.adapter?r.adapter:Me[r.adapter||"server"];return n.ui=r.login?r.login(t,r.config||{}):new Ct(t,r.ui||o),n.adapter=Object.assign({login:function(){return Promise.reject(new Error("Not implemented"))},logout:function(){return Promise.reject(new Error("Not implemented"))},init:function(){return Promise.resolve(!0)},destroy:function(){}},i(t,r.config||{})),n.callback=function(){},n}return b()(e,t),p()(e,[{key:"init",value:function(){var t=this;return this.core.singleton("osjs/auth",function(){return{show:function(e){return t.show(e)},login:function(e){return t.login(e)},logout:function(e){return t.logout(e)},user:function(){return t.core.getUser()}}}),this.ui.on("login:post",function(e){return t.login(e)}),this.adapter.init()}},{key:"destroy",value:function(){return this.ui.destroy(),_()(g()(e.prototype),"destroy",this).call(this)}},{key:"provides",value:function(){return["osjs/auth"]}},{key:"show",value:function(t){var e=this.core.config("auth.login",{}),n=e.username&&e.password;this.callback=t,this.ui.init(n),n&&this.login(e)}},{key:"login",value:function(){var t=Ie()(Re.a.mark(function t(e){var n;return Re.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.ui.emit("login:start"),t.prev=1,t.next=4,this.adapter.login(e);case 4:if(n=t.sent){t.next=7;break}return t.abrupt("return",!1);case 7:return this.ui.destroy(),this.callback(n),t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t.catch(1),this.core.config("development")&&console.warn(t.t0),this.ui.emit("login:error","Login failed"),t.abrupt("return",!1);case 17:return t.prev=17,this.ui.emit("login:stop"),t.finish(17);case 20:case"end":return t.stop()}},t,this,[[1,12,17,20]])}));return function(e){return t.apply(this,arguments)}}()},{key:"logout",value:function(){var t=Ie()(Re.a.mark(function t(){var e,n=arguments;return Re.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=!(n.length>0&&void 0!==n[0])||n[0],t.next=3,this.adapter.logout(e);case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:try{this.core.destroy()}catch(t){console.warn(t)}e&&setTimeout(function(){window.location.reload()},1);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(Q.ServiceProvider),Fe=n(17),Ue=n.n(Fe),Ge=function(t){return{clear:function(t){return localStorage.removeItem(t),Promise.resolve(!0)},save:function(t){return Object.keys(t).forEach(function(e){localStorage.setItem(e,JSON.stringify(t[e]))}),Promise.resolve(!0)},load:function(){return Promise.resolve(Object.keys(localStorage).reduce(function(t,e){var n=localStorage.getItem(e);try{n=JSON.parse(n)}catch(t){console.warn("localStorageAdapter parse error",t)}return Object.assign(t,u()({},e,n))},{}))}}},He={server:function(t){return{save:function(e){return t.request(t.url("/settings"),{method:"post",body:e},"json")},load:function(){return t.request(t.url("/settings"),{method:"get"},"json")}}},localStorage:Ge},Ke=function(){function t(e,n){d()(this,t);var r=e.config("standalone")?Ge:"function"==typeof n.adapter?n.adapter:He[n.adapter||"localStorage"];this.adapter=Object.assign({load:function(){return Promise.reject(new Error("Not implemented"))},save:function(){return Promise.reject(new Error("Not implemented"))},init:function(){return Promise.resolve(!0)},clear:function(){return Promise.resolve(!0)},destroy:function(){}},r(e,n.config)),this.debounce=null,this.settings={},this.core=e}return p()(t,[{key:"init",value:function(){return this.adapter.init()}},{key:"save",value:function(){var t=this;return new Promise(function(e,n){if(t.debounce){var r=H()(t.debounce,2),o=r[0],i=r[1];o.resolve(!1),t.debounce=clearTimeout(i)}t.debounce=[{resolve:e,reject:n},setTimeout(function(){t.adapter.save(t.settings).then(function(){t.core.emit("osjs/settings:save"),e.apply(void 0,arguments)}).catch(n)},100)]})}},{key:"load",value:function(){var t=this;this.core.emit("osjs/settings:load");var e=this.core.config("settings.defaults",{});return this.adapter.load().then(function(n){return t.settings=Et(e,n,{arrayMerge:function(t,e){return e}}),!0}).catch(function(n){return console.warn("Failed to set settings",n),t.settings=e,!1})}},{key:"get",value:function(t,e,n){if(void 0===t)return Object.assign({},this.settings);if(void 0===this.settings[t])return n||{};var r=Ue()(this.settings[t]);return e?r.get(e,n):r.get()||n}},{key:"set",value:function(t,e,n){if(-1!==this.core.config("settings.lock",[]).indexOf(t))return this;if(void 0===this.settings[t]&&(this.settings[t]={}),e)try{var r=Ue()(this.settings[t]);r.set(e,n),this.settings[t]=r.get()}catch(t){console.warn(t)}else this.settings[t]=Object.assign({},n);return this}},{key:"clear",value:function(t){var e=this;return this.adapter.clear(t).then(function(n){return n&&e.settings[t]&&delete e.settings[t],n})}}]),t}(),$e=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d()(this,e),(n=v()(this,g()(e).call(this,t))).settings=new Ke(t,Object.assign({config:{}},r)),n}return b()(e,t),p()(e,[{key:"provides",value:function(){return["osjs/settings"]}},{key:"init",value:function(){var t=this;return this.core.singleton("osjs/settings",function(){return{save:function(){return t.settings.save()},load:function(){return t.settings.load()},clear:function(){var e;return(e=t.settings).clear.apply(e,arguments)},get:function(){var e;return(e=t.settings).get.apply(e,arguments)},set:function(){var e;return(e=t.settings).set.apply(e,arguments)}}}),this.settings.init()}}]),e}(Q.ServiceProvider);n.d(e,"Core",function(){return dt}),n.d(e,"Window",function(){return U}),n.d(e,"Desktop",function(){return bt}),n.d(e,"Application",function(){return X}),n.d(e,"Notification",function(){return At}),n.d(e,"WindowBehavior",function(){return Pt}),n.d(e,"Login",function(){return Ct}),n.d(e,"Websocket",function(){return T}),n.d(e,"CoreServiceProvider",function(){return Xt}),n.d(e,"DesktopServiceProvider",function(){return Qt}),n.d(e,"NotificationServiceProvider",function(){return Jt}),n.d(e,"VFSServiceProvider",function(){return Ne}),n.d(e,"AuthServiceProvider",function(){return De}),n.d(e,"SettingsServiceProvider",function(){return $e})}])});
//# sourceMappingURL=main.js.map